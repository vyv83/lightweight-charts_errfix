# –ë–ê–ì #41: –ù–µ–ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –±–∞—Ä–æ–≤ –º–µ–∂–¥—É –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

> **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° –°–†–ï–î–ù–Ø–Ø  
> **Issue:** [#1860](https://github.com/tradingview/lightweight-charts/issues/1860)  
> **–í–µ—Ä—Å–∏–∏:** –í—Å–µ –≤–µ—Ä—Å–∏–∏  
> **–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è Working as Intended (–∑–∞–∫—Ä—ã—Ç)

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –°—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
–í histogram series –≤—ã—Å–æ—Ç–∞ –±–∞—Ä–æ–≤ –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π **–Ω–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞** –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –±–∞–∑–æ–≤–æ–π –ª–∏–Ω–∏–∏ (zero line). –≠—Ç–æ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∫–∞–∫ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ —Ç–∏–ø–∞ MACD, –æ—Å—Ü–∏–ª–ª—è—Ç–æ—Ä–æ–≤ –∏–ª–∏ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

### –ü—Ä–æ—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã

1. **–ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ë–∞—Ä —Å –∑–Ω–∞—á–µ–Ω–∏–µ–º `+10` –∏ –±–∞—Ä —Å `-10` –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—É—é –≤–∏–∑—É–∞–ª—å–Ω—É—é –≤—ã—Å–æ—Ç—É
   - –ù—É–ª–µ–≤–∞—è –ª–∏–Ω–∏—è –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç–æ—á–Ω–æ –ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ

2. **–ù–µ–æ—á–µ–≤–∏–¥–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
   - –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–∞–∫ –±–∞—Ä—ã, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –≤–Ω–∏–∑
   - –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –≤–∏–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

3. **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç:**
   ```javascript
   // –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
   const data = [
       { time: '2024-01-01', value: 10, color: '#26a69a' },
       { time: '2024-01-02', value: -10, color: '#ef5350' },
       // –û–∂–∏–¥–∞–Ω–∏–µ: –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è –≤–∏–∑—É–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞
       // –†–µ–∞–ª—å–Ω–æ—Å—Ç—å: –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –∏–∑-–∑–∞ –∞–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
   ];
   ```

### –î–∏–∑–∞–π–Ω-—Ä–µ—à–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

Issue #1860 –±—ã–ª **–∑–∞–∫—Ä—ã—Ç –∫–∞–∫ "Working as Intended"**. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

1. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∏–¥–∏–º–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö
2. –í–∏–∑—É–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –±–∞—Ä–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—é –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–µ–∫—É—â–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∞
3. –ù—É–ª–µ–≤–∞—è –ª–∏–Ω–∏—è –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ü–µ–Ω—Ç—Ä–µ –æ–±–ª–∞—Å—Ç–∏ –≥—Ä–∞—Ñ–∏–∫–∞

### –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

- **MACD –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä** ‚Äî –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- **RSI deviation** ‚Äî –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç —Å—Ä–µ–¥–Ω–µ–π –ª–∏–Ω–∏–∏
- **Volume delta** ‚Äî —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É buy –∏ sell volume
- **–õ—é–±—ã–µ –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã**

---

## üîç –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π –æ–∫—Ä–∞—Å–∫–æ–π (‚≠ê 8/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ (`Math.abs(value)`) –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è `color` –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ/–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ).

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –í—Å–µ –±–∞—Ä—ã –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –≤–∏–∑—É–∞–ª—å–Ω—É—é –ø—Ä–æ–ø–æ—Ä—Ü–∏—é
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –¶–≤–µ—Ç –ø–µ—Ä–µ–¥–∞—ë—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–Ω–∞–∫–µ

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –¢–µ—Ä—è–µ—Ç—Å—è –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–≤–≤–µ—Ä—Ö/–≤–Ω–∏–∑)
- ‚ùå –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω–µ–µ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
import { createChart } from 'lightweight-charts';

/**
 * –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è histogram —Å –∞–±—Å–æ–ª—é—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
 */
function convertToAbsoluteValues(data, options = {}) {
    const {
        positiveColor = '#26a69a',
        negativeColor = '#ef5350',
        zeroColor = '#888888',
    } = options;

    return data.map(point => {
        const value = point.value;
        let color;
        
        if (value > 0) {
            color = positiveColor;
        } else if (value < 0) {
            color = negativeColor;
        } else {
            color = zeroColor;
        }
        
        return {
            ...point,
            value: Math.abs(value),
            color,
            _originalValue: value, // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        };
    });
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const chart = createChart(container, { width: 800, height: 400 });

const histogramSeries = chart.addHistogramSeries({
    priceFormat: {
        type: 'volume',
    },
    priceLineVisible: false,
});

const rawData = [
    { time: '2024-01-01', value: 10 },
    { time: '2024-01-02', value: -5 },
    { time: '2024-01-03', value: 15 },
    { time: '2024-01-04', value: -20 },
];

const processedData = convertToAbsoluteValues(rawData);
histogramSeries.setData(processedData);
```

---

### –†–µ—à–µ–Ω–∏–µ 2: –î–≤–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–∏–∏ –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (‚≠ê 9/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–°–æ–∑–¥–∞–Ω–∏–µ –¥–≤—É—Ö histogram —Å–µ—Ä–∏–π ‚Äî –æ–¥–Ω–æ–π –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –¥—Ä—É–≥–æ–π –¥–ª—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞—Ä–æ–≤.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–≤–≤–µ—Ä—Ö/–≤–Ω–∏–∑)
- ‚úÖ –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π —Å–µ—Ä–∏–∏
- ‚úÖ –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –î–≤–µ —Å–µ—Ä–∏–∏ –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–π
- ‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
import { createChart } from 'lightweight-charts';

/**
 * –°–æ–∑–¥–∞—ë—Ç –¥–≤–æ–π–Ω—É—é histogram —Å–µ—Ä–∏—é –¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
 */
class SymmetricHistogramManager {
    constructor(chart, options = {}) {
        this.chart = chart;
        this.options = {
            positiveColor: options.positiveColor || '#26a69a',
            negativeColor: options.negativeColor || '#ef5350',
            priceScaleId: options.priceScaleId || 'histogram',
            scaleMargins: options.scaleMargins || { top: 0.8, bottom: 0 },
        };
        
        this._createSeries();
    }

    _createSeries() {
        // –°–µ—Ä–∏—è –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        this.positiveSeries = this.chart.addHistogramSeries({
            color: this.options.positiveColor,
            priceScaleId: this.options.priceScaleId,
            priceLineVisible: false,
            lastValueVisible: false,
        });

        // –°–µ—Ä–∏—è –¥–ª—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        this.negativeSeries = this.chart.addHistogramSeries({
            color: this.options.negativeColor,
            priceScaleId: this.options.priceScaleId,
            priceLineVisible: false,
            lastValueVisible: false,
        });

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—â–µ–π —à–∫–∞–ª—ã
        this.chart.priceScale(this.options.priceScaleId).applyOptions({
            scaleMargins: this.options.scaleMargins,
        });
    }

    /**
     * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è histogram
     */
    setData(data) {
        const positiveData = [];
        const negativeData = [];

        data.forEach(point => {
            const value = point.value;
            
            if (value >= 0) {
                positiveData.push({
                    time: point.time,
                    value: value,
                    color: this.options.positiveColor,
                });
                // –î–æ–±–∞–≤–ª—è–µ–º whitespace –≤ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—É—é —Å–µ—Ä–∏—é
                negativeData.push({ time: point.time });
            } else {
                negativeData.push({
                    time: point.time,
                    value: value,
                    color: this.options.negativeColor,
                });
                // –î–æ–±–∞–≤–ª—è–µ–º whitespace –≤ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—É—é —Å–µ—Ä–∏—é
                positiveData.push({ time: point.time });
            }
        });

        this.positiveSeries.setData(positiveData);
        this.negativeSeries.setData(negativeData);
    }

    /**
     * –û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é —Ç–æ—á–∫—É
     */
    update(point) {
        const value = point.value;
        
        if (value >= 0) {
            this.positiveSeries.update({
                time: point.time,
                value: value,
                color: this.options.positiveColor,
            });
            this.negativeSeries.update({ time: point.time });
        } else {
            this.negativeSeries.update({
                time: point.time,
                value: value,
                color: this.options.negativeColor,
            });
            this.positiveSeries.update({ time: point.time });
        }
    }

    /**
     * –£–¥–∞–ª—è–µ—Ç —Å–µ—Ä–∏–∏
     */
    remove() {
        this.chart.removeSeries(this.positiveSeries);
        this.chart.removeSeries(this.negativeSeries);
    }
}

// ============ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ============

const chart = createChart(container, {
    width: 800,
    height: 400,
    layout: {
        background: { type: 'solid', color: '#1e222d' },
        textColor: '#d1d4dc',
    },
});

// –î–æ–±–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Å–µ—Ä–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–≤–µ—á–∏)
const candleSeries = chart.addCandlestickSeries();
candleSeries.setData(priceData);

// –°–æ–∑–¥–∞—ë–º —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—É—é histogram
const histogramManager = new SymmetricHistogramManager(chart, {
    positiveColor: '#26a69a',
    negativeColor: '#ef5350',
    scaleMargins: { top: 0.7, bottom: 0 },
});

// MACD histogram –¥–∞–Ω–Ω—ã–µ
const macdHistogram = [
    { time: '2024-01-01', value: 0.5 },
    { time: '2024-01-02', value: 0.8 },
    { time: '2024-01-03', value: -0.3 },
    { time: '2024-01-04', value: -0.7 },
    { time: '2024-01-05', value: 0.2 },
];

histogramManager.setData(macdHistogram);
```

---

### –†–µ—à–µ–Ω–∏–µ 3: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ (‚≠ê 8/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–ª—è price scale (`-max` –¥–æ `+max`).

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù—É–ª–µ–≤–∞—è –ª–∏–Ω–∏—è —Ç–æ—á–Ω–æ –ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ
- ‚úÖ –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –æ–¥–Ω–æ–π —Å–µ—Ä–∏–µ–π

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –û—Ç–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
import { createChart } from 'lightweight-charts';

/**
 * –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
 */
class SymmetricScaleManager {
    constructor(chart, series, priceScaleId = 'right') {
        this.chart = chart;
        this.series = series;
        this.priceScaleId = priceScaleId;
        this.currentData = [];
    }

    /**
     * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º
     */
    setData(data) {
        this.currentData = data;
        this.series.setData(data);
        this._applySymmetricScale();
    }

    /**
     * –û–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ
     */
    update(point) {
        // –ù–∞—Ö–æ–¥–∏–º –∏–ª–∏ –¥–æ–±–∞–≤–ª—è–µ–º —Ç–æ—á–∫—É
        const existingIndex = this.currentData.findIndex(
            d => d.time === point.time
        );
        
        if (existingIndex >= 0) {
            this.currentData[existingIndex] = point;
        } else {
            this.currentData.push(point);
        }
        
        this.series.update(point);
        this._applySymmetricScale();
    }

    _applySymmetricScale() {
        // –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        const maxAbsValue = this.currentData.reduce((max, point) => {
            const absValue = Math.abs(point.value || 0);
            return Math.max(max, absValue);
        }, 0);

        if (maxAbsValue === 0) return;

        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à–æ–π padding (10%)
        const padding = maxAbsValue * 0.1;
        const range = maxAbsValue + padding;

        // –û—Ç–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω
        this.chart.priceScale(this.priceScaleId).applyOptions({
            autoScale: false,
        });

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
        // –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: Lightweight Charts –Ω–µ –∏–º–µ–µ—Ç –ø—Ä—è–º–æ–≥–æ –º–µ—Ç–æ–¥–∞ setMinMax,
        // –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º workaround —á–µ—Ä–µ–∑ scaleMargins
        this.series.applyOptions({
            autoscaleInfoProvider: () => ({
                priceRange: {
                    minValue: -range,
                    maxValue: range,
                },
                margins: {
                    above: 0.1,
                    below: 0.1,
                },
            }),
        });
    }

    /**
     * –í–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ
     */
    enableAutoScale() {
        this.chart.priceScale(this.priceScaleId).applyOptions({
            autoScale: true,
        });
        this.series.applyOptions({
            autoscaleInfoProvider: undefined,
        });
    }
}

// ============ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ============

const chart = createChart(container, { width: 800, height: 400 });

const histogramSeries = chart.addHistogramSeries({
    color: '#2962FF',
    priceLineVisible: false,
});

const scaleManager = new SymmetricScaleManager(chart, histogramSeries);

const data = [
    { time: '2024-01-01', value: 10, color: '#26a69a' },
    { time: '2024-01-02', value: -5, color: '#ef5350' },
    { time: '2024-01-03', value: 15, color: '#26a69a' },
    { time: '2024-01-04', value: -20, color: '#ef5350' },
];

scaleManager.setData(data);
```

---

### –†–µ—à–µ–Ω–∏–µ 4: Custom autoscaleInfoProvider (‚≠ê 9/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `autoscaleInfoProvider` –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏–º–º–µ—Ç—Ä–∏–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω—É–ª—è.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–∞—Ç–∏–≤–Ω—ã–π API
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –¥–∞–Ω–Ω—ã–º
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ú–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –¥—Ä—É–≥–∏–µ —Å–µ—Ä–∏–∏ –Ω–∞ —Ç–æ–π –∂–µ —à–∫–∞–ª–µ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
import { createChart } from 'lightweight-charts';

/**
 * –°–æ–∑–¥–∞—ë—Ç autoscaleInfoProvider –¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
 */
function createSymmetricAutoscaleProvider(seriesData) {
    return (original) => {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç –∫–∞–∫ –±–∞–∑—É
        const res = original();
        
        if (!res || !res.priceRange) {
            return res;
        }

        const { minValue, maxValue } = res.priceRange;
        
        // –í—ã—á–∏—Å–ª—è–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        const maxAbs = Math.max(Math.abs(minValue), Math.abs(maxValue));
        
        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
        return {
            priceRange: {
                minValue: -maxAbs,
                maxValue: maxAbs,
            },
            margins: res.margins,
        };
    };
}

// ============ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ============

const chart = createChart(container, {
    width: 800,
    height: 400,
    layout: {
        background: { type: 'solid', color: '#1e222d' },
        textColor: '#d1d4dc',
    },
});

const histogramSeries = chart.addHistogramSeries({
    color: '#2962FF',
    priceLineVisible: false,
    autoscaleInfoProvider: createSymmetricAutoscaleProvider(),
});

const data = [
    { time: '2024-01-01', value: 10, color: '#26a69a' },
    { time: '2024-01-02', value: -5, color: '#ef5350' },
    { time: '2024-01-03', value: 15, color: '#26a69a' },
    { time: '2024-01-04', value: -20, color: '#ef5350' },
    { time: '2024-01-05', value: 8, color: '#26a69a' },
];

histogramSeries.setData(data);
chart.timeScale().fitContent();
```

---

### –†–µ—à–µ–Ω–∏–µ 5: Baseline Series –≤–º–µ—Å—Ç–æ Histogram (‚≠ê 7/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `BaselineSeries` –≤–º–µ—Å—Ç–æ `HistogramSeries` –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Å –±–∞–∑–æ–≤–æ–π –ª–∏–Ω–∏–µ–π.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ baseline
- ‚úÖ –†–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞ –≤—ã—à–µ –∏ –Ω–∏–∂–µ –ª–∏–Ω–∏–∏
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–æ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –≠—Ç–æ line/area, –∞ –Ω–µ –±–∞—Ä—ã
- ‚ùå –ú–æ–∂–µ—Ç –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è histogram-style –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
import { createChart } from 'lightweight-charts';

const chart = createChart(container, {
    width: 800,
    height: 400,
    layout: {
        background: { type: 'solid', color: '#1e222d' },
        textColor: '#d1d4dc',
    },
});

const baselineSeries = chart.addBaselineSeries({
    baseValue: { type: 'price', price: 0 },
    topLineColor: 'rgba(38, 166, 154, 1)',
    topFillColor1: 'rgba(38, 166, 154, 0.28)',
    topFillColor2: 'rgba(38, 166, 154, 0.05)',
    bottomLineColor: 'rgba(239, 83, 80, 1)',
    bottomFillColor1: 'rgba(239, 83, 80, 0.05)',
    bottomFillColor2: 'rgba(239, 83, 80, 0.28)',
});

const data = [
    { time: '2024-01-01', value: 10 },
    { time: '2024-01-02', value: -5 },
    { time: '2024-01-03', value: 15 },
    { time: '2024-01-04', value: -20 },
    { time: '2024-01-05', value: 8 },
];

baselineSeries.setData(data);
chart.timeScale().fitContent();
```

---

### –†–µ—à–µ–Ω–∏–µ 6: Custom Series –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è (‚≠ê 6/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–°–æ–∑–¥–∞–Ω–∏–µ Custom Series (–¥–æ—Å—Ç—É–ø–Ω–æ —Å v4.1) –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º –±–∞—Ä–æ–≤.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –æ—Ç—Ä–∏—Å–æ–≤–∫–æ–π
- ‚úÖ –õ—é–±–∞—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –í—ã—Å–æ–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è Canvas API

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (—É–ø—Ä–æ—â—ë–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä):**
```javascript
import { createChart, customSeriesDefaultOptions } from 'lightweight-charts';

/**
 * –ö–∞—Å—Ç–æ–º–Ω–∞—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è histogram —Å–µ—Ä–∏—è
 */
class SymmetricHistogramSeries {
    constructor() {
        this._options = {
            ...customSeriesDefaultOptions,
            positiveColor: '#26a69a',
            negativeColor: '#ef5350',
            barWidth: 0.8, // –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
        };
    }

    priceValueBuilder(plotRow) {
        return [plotRow.value];
    }

    isWhitespace(data) {
        return data.value === undefined;
    }

    renderer() {
        return new SymmetricHistogramRenderer();
    }

    update(options) {
        this._options = { ...this._options, ...options };
    }

    defaultOptions() {
        return this._options;
    }
}

class SymmetricHistogramRenderer {
    draw(target, priceConverter) {
        target.useBitmapCoordinateSpace((scope) => {
            const ctx = scope.context;
            const data = scope.seriesData;
            
            if (!data || data.length === 0) return;

            // –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
            const maxAbs = data.reduce((max, bar) => {
                return Math.max(max, Math.abs(bar.originalValue || bar.value || 0));
            }, 0);

            data.forEach((bar) => {
                if (bar.value === undefined) return;

                const x = bar.x;
                const width = bar.columnWidth * 0.8;
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—ã—Å–æ—Ç—É –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
                const normalizedValue = bar.originalValue / maxAbs;
                const centerY = scope.bitmapSize.height / 2;
                const maxHeight = scope.bitmapSize.height / 2;
                const barHeight = normalizedValue * maxHeight;

                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ü–≤–µ—Ç
                const color = bar.originalValue >= 0 
                    ? this._options.positiveColor 
                    : this._options.negativeColor;

                ctx.fillStyle = color;
                
                if (bar.originalValue >= 0) {
                    ctx.fillRect(
                        x - width / 2,
                        centerY - barHeight,
                        width,
                        barHeight
                    );
                } else {
                    ctx.fillRect(
                        x - width / 2,
                        centerY,
                        width,
                        Math.abs(barHeight)
                    );
                }
            });

            // –†–∏—Å—É–µ–º –Ω—É–ª–µ–≤—É—é –ª–∏–Ω–∏—é
            ctx.strokeStyle = '#888888';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(0, scope.bitmapSize.height / 2);
            ctx.lineTo(scope.bitmapSize.width, scope.bitmapSize.height / 2);
            ctx.stroke();
        });
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const chart = createChart(container, { width: 800, height: 400 });

const customSeries = chart.addCustomSeries(new SymmetricHistogramSeries(), {
    positiveColor: '#26a69a',
    negativeColor: '#ef5350',
});

const data = [
    { time: '2024-01-01', value: 10 },
    { time: '2024-01-02', value: -5 },
    { time: '2024-01-03', value: 15 },
    { time: '2024-01-04', value: -20 },
];

// –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
const processedData = data.map(d => ({
    time: d.time,
    value: Math.abs(d.value),
    originalValue: d.value,
}));

customSeries.setData(processedData);
```

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: autoscaleInfoProvider + —Ä–∞–∑–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–∏–∏

–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è histogram —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `autoscaleInfoProvider` —Å —Ä–∞–∑–¥–µ–ª—å–Ω—ã–º–∏ —Å–µ—Ä–∏—è–º–∏:

```javascript
import { createChart } from 'lightweight-charts';

/**
 * –ü–æ–ª–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π histogram
 */
class AdvancedSymmetricHistogram {
    constructor(chart, options = {}) {
        this.chart = chart;
        this.options = {
            positiveColor: options.positiveColor || '#26a69a',
            negativeColor: options.negativeColor || '#ef5350',
            priceScaleId: options.priceScaleId || 'histogram',
            scaleMargins: options.scaleMargins || { top: 0.7, bottom: 0 },
        };
        
        this.positiveSeries = null;
        this.negativeSeries = null;
        this.data = [];
        
        this._init();
    }

    _init() {
        const symmetricProvider = this._createSymmetricProvider();

        // –°–µ—Ä–∏—è –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        this.positiveSeries = this.chart.addHistogramSeries({
            color: this.options.positiveColor,
            priceScaleId: this.options.priceScaleId,
            priceLineVisible: false,
            lastValueVisible: false,
            autoscaleInfoProvider: symmetricProvider,
        });

        // –°–µ—Ä–∏—è –¥–ª—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        this.negativeSeries = this.chart.addHistogramSeries({
            color: this.options.negativeColor,
            priceScaleId: this.options.priceScaleId,
            priceLineVisible: false,
            lastValueVisible: false,
            autoscaleInfoProvider: symmetricProvider,
        });

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∫–∞–ª—ã
        this.chart.priceScale(this.options.priceScaleId).applyOptions({
            scaleMargins: this.options.scaleMargins,
        });
    }

    _createSymmetricProvider() {
        const self = this;
        
        return (original) => {
            const res = original();
            
            if (!res || !res.priceRange) return res;

            // –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –¥–∞–Ω–Ω—ã—Ö
            const maxAbs = self.data.reduce((max, point) => {
                return Math.max(max, Math.abs(point.value || 0));
            }, 0);

            if (maxAbs === 0) return res;

            // –î–æ–±–∞–≤–ª—è–µ–º 10% padding
            const paddedMax = maxAbs * 1.1;

            return {
                priceRange: {
                    minValue: -paddedMax,
                    maxValue: paddedMax,
                },
                margins: {
                    above: 0.05,
                    below: 0.05,
                },
            };
        };
    }

    /**
     * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
     */
    setData(data) {
        this.data = data;
        
        const positiveData = [];
        const negativeData = [];

        data.forEach(point => {
            const value = point.value;
            
            if (value >= 0) {
                positiveData.push({
                    time: point.time,
                    value: value,
                    color: point.color || this.options.positiveColor,
                });
                negativeData.push({ time: point.time });
            } else {
                negativeData.push({
                    time: point.time,
                    value: value,
                    color: point.color || this.options.negativeColor,
                });
                positiveData.push({ time: point.time });
            }
        });

        this.positiveSeries.setData(positiveData);
        this.negativeSeries.setData(negativeData);
    }

    /**
     * –û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é —Ç–æ—á–∫—É
     */
    update(point) {
        // –û–±–Ω–æ–≤–ª—è–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö
        const existingIndex = this.data.findIndex(d => d.time === point.time);
        if (existingIndex >= 0) {
            this.data[existingIndex] = point;
        } else {
            this.data.push(point);
        }

        const value = point.value;
        
        if (value >= 0) {
            this.positiveSeries.update({
                time: point.time,
                value: value,
                color: point.color || this.options.positiveColor,
            });
            this.negativeSeries.update({ time: point.time });
        } else {
            this.negativeSeries.update({
                time: point.time,
                value: value,
                color: point.color || this.options.negativeColor,
            });
            this.positiveSeries.update({ time: point.time });
        }
    }

    /**
     * –ü—Ä–∏–º–µ–Ω—è–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—É—é –æ–∫—Ä–∞—Å–∫—É –ø–æ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏
     */
    applyGradientColors(basePositiveColor, baseNegativeColor) {
        this.data = this.data.map(point => {
            const maxAbs = Math.max(...this.data.map(d => Math.abs(d.value)));
            const intensity = Math.abs(point.value) / maxAbs;
            
            // –í—ã—á–∏—Å–ª—è–µ–º —Ü–≤–µ—Ç —Å —É—á—ë—Ç–æ–º –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏
            const baseColor = point.value >= 0 ? basePositiveColor : baseNegativeColor;
            const color = this._adjustColorIntensity(baseColor, intensity);
            
            return { ...point, color };
        });
        
        this.setData(this.data);
    }

    _adjustColorIntensity(hexColor, intensity) {
        // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º hex –≤ RGB
        const r = parseInt(hexColor.slice(1, 3), 16);
        const g = parseInt(hexColor.slice(3, 5), 16);
        const b = parseInt(hexColor.slice(5, 7), 16);
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å (–æ—Ç 0.3 –¥–æ 1.0)
        const adjustedIntensity = 0.3 + intensity * 0.7;
        
        const newR = Math.round(r * adjustedIntensity);
        const newG = Math.round(g * adjustedIntensity);
        const newB = Math.round(b * adjustedIntensity);
        
        return `rgb(${newR}, ${newG}, ${newB})`;
    }

    /**
     * –£–¥–∞–ª—è–µ—Ç —Å–µ—Ä–∏–∏
     */
    remove() {
        this.chart.removeSeries(this.positiveSeries);
        this.chart.removeSeries(this.negativeSeries);
    }
}

// ============ –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ============

const container = document.getElementById('chart');

const chart = createChart(container, {
    width: 1000,
    height: 500,
    layout: {
        background: { type: 'solid', color: '#131722' },
        textColor: '#d1d4dc',
    },
    grid: {
        vertLines: { color: 'rgba(42, 46, 57, 0.6)' },
        horzLines: { color: 'rgba(42, 46, 57, 0.6)' },
    },
});

// –û—Å–Ω–æ–≤–Ω–∞—è —Å–µ—Ä–∏—è (—Å–≤–µ—á–∏)
const candleSeries = chart.addCandlestickSeries({
    upColor: '#26a69a',
    downColor: '#ef5350',
    borderVisible: false,
    wickUpColor: '#26a69a',
    wickDownColor: '#ef5350',
});

candleSeries.setData(priceData);

// –°–æ–∑–¥–∞—ë–º —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—É—é MACD histogram
const macdHistogram = new AdvancedSymmetricHistogram(chart, {
    positiveColor: '#26a69a',
    negativeColor: '#ef5350',
    scaleMargins: { top: 0.75, bottom: 0 },
});

// –î–∞–Ω–Ω—ã–µ MACD histogram
const macdData = [
    { time: '2024-01-01', value: 0.5 },
    { time: '2024-01-02', value: 0.8 },
    { time: '2024-01-03', value: 1.2 },
    { time: '2024-01-04', value: 0.6 },
    { time: '2024-01-05', value: -0.3 },
    { time: '2024-01-06', value: -0.7 },
    { time: '2024-01-07', value: -1.1 },
    { time: '2024-01-08', value: -0.5 },
    { time: '2024-01-09', value: 0.2 },
    { time: '2024-01-10', value: 0.9 },
];

macdHistogram.setData(macdData);
chart.timeScale().fitContent();

// Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
function simulateRealtimeUpdate() {
    const lastTime = macdData[macdData.length - 1].time;
    const nextDay = new Date(lastTime);
    nextDay.setDate(nextDay.getDate() + 1);
    
    const newValue = (Math.random() - 0.5) * 2.4;
    
    macdHistogram.update({
        time: nextDay.toISOString().split('T')[0],
        value: newValue,
    });
}
```

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ—à–µ–Ω–∏–π

| –†–µ—à–µ–Ω–∏–µ | –û—Ü–µ–Ω–∫–∞ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –°–∏–º–º–µ—Ç—Ä–∏—è | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | Real-time |
|---------|--------|-----------|-----------|-------------|-----------|
| **autoscaleInfoProvider** | ‚≠ê 9/10 | –ù–∏–∑–∫–∞—è | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚úÖ –î–∞ |
| –î–≤–µ —Å–µ—Ä–∏–∏ | ‚≠ê 9/10 | –°—Ä–µ–¥–Ω—è—è | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚úÖ –î–∞ |
| –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω | ‚≠ê 8/10 | –°—Ä–µ–¥–Ω—è—è | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚ö†Ô∏è –ü–µ—Ä–µ—Å—á—ë—Ç |
| –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è | ‚≠ê 8/10 | –ù–∏–∑–∫–∞—è | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |
| Baseline Series | ‚≠ê 7/10 | –ù–∏–∑–∫–∞—è | ‚úÖ –î–∞ | ‚ö†Ô∏è Area | ‚úÖ –î–∞ |
| Custom Series | ‚≠ê 6/10 | –í—ã—Å–æ–∫–∞—è | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚úÖ –î–∞ |

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Issue #1860 –∑–∞–∫—Ä—ã—Ç –∫–∞–∫ "Working as Intended"** ‚Äî —ç—Ç–æ –Ω–µ –±–∞–≥, –∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.

2. **`autoscaleInfoProvider`** ‚Äî —Å–∞–º—ã–π —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è.

3. **–î–≤–µ —Å–µ—Ä–∏–∏ vs –æ–¥–Ω–∞** ‚Äî –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–≤–µ —Å–µ—Ä–∏–∏ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è + –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è).

4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚Äî –≤—Å–µ —Ä–µ—à–µ–Ω–∏—è –∏–º–µ—é—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

---

## üîó –ò—Å—Ç–æ—á–Ω–∏–∫–∏

1. [GitHub Issue #1860 - Height of bars are not consistent between positive and negative values](https://github.com/tradingview/lightweight-charts/issues/1860)
2. [Lightweight Charts - Histogram Series](https://tradingview.github.io/lightweight-charts/docs/series-types/histogram)
3. [Lightweight Charts - autoscaleInfoProvider](https://tradingview.github.io/lightweight-charts/docs/api/interfaces/SeriesOptionsCommon#autoscaleinfoprovider)
4. [Lightweight Charts - Custom Series](https://tradingview.github.io/lightweight-charts/docs/plugins/custom_series)
5. [Stack Overflow - Histogram with negative values](https://stackoverflow.com/questions/tagged/lightweight-charts+histogram)

---

## üìÖ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –î–∞—Ç–∞ | –í–µ—Ä—Å–∏—è | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|--------|-----------|
| 2026-01-18 | 1.0 | –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ |

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ lightweight-charts error tracking*

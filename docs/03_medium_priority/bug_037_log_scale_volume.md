# –ë–ê–ì #37: –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏–π –º–∞—Å—à—Ç–∞–± –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –æ–±—ä—ë–º—É

> **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° –°–†–ï–î–ù–Ø–Ø  
> **Issue:** [#227](https://github.com/tradingview/lightweight-charts/issues/227)  
> **–í–µ—Ä—Å–∏–∏:** v1.1.0 (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ v1.2.1+)  
> **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (–Ω–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ)

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –°—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã

–ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∞ (`mode: 'logarithmic'`) –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–µ–Ω–æ–≤–æ–π —à–∫–∞–ª—ã, —ç—Ç–æ—Ç —Ä–µ–∂–∏–º **—Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ –æ–±—ä—ë–º–∞**, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—é volume bars.

### –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

**–ë–∞–≥ –±—ã–ª –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –≤ –≤–µ—Ä—Å–∏–∏ 1.2.1** (–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω –≤ release notes v4.2.0). –û–¥–Ω–∞–∫–æ –ø—Ä–æ–±–ª–µ–º–∞ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å, –µ—Å–ª–∏:

1. **Volume –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Ç–æ–π –∂–µ price scale**, —á—Ç–æ –∏ price data
2. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** –±–µ–∑ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è scales
3. **–ù–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è –º–µ—Ö–∞–Ω–∏–∑–º–∞ overlay scales**

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

- –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏–π –º–∞—Å—à—Ç–∞–± –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –∫ —Ü–µ–Ω–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º**
- Volume histogram –≤—Å–µ–≥–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ **–ª–∏–Ω–µ–π–Ω–æ–º –º–∞—Å—à—Ç–∞–±–µ**
- –ö–∞–∂–¥–∞—è —Å–µ—Ä–∏—è –º–æ–∂–µ—Ç –∏–º–µ—Ç—å **—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —à–∫–∞–ª—É** —Å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã (–≤ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö)

```typescript
// –ü—Ä–æ–±–ª–µ–º–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π (pre-1.2.1)
const chart = createChart(container, {
  rightPriceScale: {
    mode: PriceScaleMode.Logarithmic, // –ü—Ä–∏–º–µ–Ω—è–ª—Å—è –∫–æ –í–°–ï–ú —Å–µ—Ä–∏—è–º –Ω–∞ —ç—Ç–æ–π —à–∫–∞–ª–µ
  },
});

const candlestickSeries = chart.addCandlestickSeries();
const volumeSeries = chart.addHistogramSeries(); // –¢–æ–∂–µ –ø–æ–ª—É—á–∞–ª log scale!
```

### –í–ª–∏—è–Ω–∏–µ

- **–í–∏–∑—É–∞–ª—å–Ω–æ–µ –∏—Å–∫–∞–∂–µ–Ω–∏–µ** ‚Äî –æ–±—ä—ë–º –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–µ–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- **–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞** ‚Äî –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –æ–±—ä—ë–º—ã
- **–ü—É—Ç–∞–Ω–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** ‚Äî –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö —Ä–∞–∑–ª–∏—á–∏—è—Ö –≤ volume

---

## üîç –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é overlay scale –¥–ª—è volume (–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ)

**–†–µ–π—Ç–∏–Ω–≥:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (10/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ù–∞–∑–Ω–∞—á–∏—Ç—å volume series –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—É—é overlay price scale —Å –ª–∏–Ω–µ–π–Ω—ã–º —Ä–µ–∂–∏–º–æ–º.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥
- –ü–æ–ª–Ω–∞—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–∞—Å—à—Ç–∞–±–æ–≤
- –ì–∏–±–∫–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ volume

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –¢—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ scaleMargins

```typescript
import {
  createChart,
  IChartApi,
  ISeriesApi,
  PriceScaleMode,
  CandlestickData,
  HistogramData,
  Time,
} from 'lightweight-charts';

// –°–æ–∑–¥–∞—ë–º –≥—Ä–∞—Ñ–∏–∫ —Å –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏–º –º–∞—Å—à—Ç–∞–±–æ–º –¥–ª—è —Ü–µ–Ω
const chart = createChart(container, {
  width: 800,
  height: 400,
  rightPriceScale: {
    mode: PriceScaleMode.Logarithmic, // –î–ª—è —Ü–µ–Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    visible: true,
  },
  // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ overlay scales (–¥–ª—è volume)
  overlayPriceScales: {
    mode: PriceScaleMode.Normal, // –õ–ò–ù–ï–ô–ù–´–ô –¥–ª—è overlays
  },
});

// Candlestick —Å–µ—Ä–∏—è –Ω–∞ –ø—Ä–∞–≤–æ–π —à–∫–∞–ª–µ (—Å –ª–æ–≥–∞—Ä–∏—Ñ–º–æ–º)
const candlestickSeries = chart.addCandlestickSeries({
  priceScaleId: 'right', // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç rightPriceScale
});

// Volume —Å–µ—Ä–∏—è –Ω–∞ –û–¢–î–ï–õ–¨–ù–û–ô overlay —à–∫–∞–ª–µ (–ª–∏–Ω–µ–π–Ω–æ–π)
const volumeSeries = chart.addHistogramSeries({
  priceScaleId: 'volume', // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–æ–∑–¥–∞—ë—Ç overlay scale
  color: '#26a69a',
  priceFormat: {
    type: 'volume',
  },
  priceLineVisible: false,
  lastValueVisible: false,
});

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ volume (–≤–Ω–∏–∑—É –≥—Ä–∞—Ñ–∏–∫–∞)
volumeSeries.priceScale().applyOptions({
  scaleMargins: {
    top: 0.85, // Volume –∑–∞–Ω–∏–º–∞–µ—Ç –Ω–∏–∂–Ω–∏–µ 15%
    bottom: 0,
  },
  mode: PriceScaleMode.Normal, // –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ª–∏–Ω–µ–π–Ω—ã–π
});

// –î–∞–Ω–Ω—ã–µ
candlestickSeries.setData(priceData);
volumeSeries.setData(volumeData);
```

---

### –†–µ—à–µ–Ω–∏–µ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–µ–≤—É—é —à–∫–∞–ª—É –¥–ª—è volume

**–†–µ–π—Ç–∏–Ω–≥:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (9/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ù–∞–∑–Ω–∞—á–∏—Ç—å volume –Ω–∞ –ª–µ–≤—É—é price scale, –æ—Å—Ç–∞–≤–∏–≤ –ø—Ä–∞–≤—É—é –¥–ª—è —Ü–µ–Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ß—ë—Ç–∫–æ–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ
- –ú–µ—Ç–∫–∏ volume –≤–∏–¥–Ω—ã –Ω–∞ –ª–µ–≤–æ–π –æ—Å–∏
- –ü—Ä–æ—Å—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –ó–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–æ –Ω–∞ –ª–µ–≤–æ–π —Å—Ç–æ—Ä–æ–Ω–µ
- –ú–æ–∂–µ—Ç –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –≤—Å–µ—Ö layout

```typescript
const chart = createChart(container, {
  width: 800,
  height: 500,
  rightPriceScale: {
    mode: PriceScaleMode.Logarithmic, // –õ–æ–≥–∞—Ä–∏—Ñ–º –¥–ª—è —Ü–µ–Ω
    visible: true,
  },
  leftPriceScale: {
    mode: PriceScaleMode.Normal, // –õ–∏–Ω–µ–π–Ω—ã–π –¥–ª—è volume
    visible: true,
    scaleMargins: {
      top: 0.7,
      bottom: 0,
    },
  },
});

// Candlestick –Ω–∞ –ø—Ä–∞–≤–æ–π —à–∫–∞–ª–µ
const candlestickSeries = chart.addCandlestickSeries({
  priceScaleId: 'right',
});

// Volume –Ω–∞ –ª–µ–≤–æ–π —à–∫–∞–ª–µ
const volumeSeries = chart.addHistogramSeries({
  priceScaleId: 'left',
  color: '#26a69a',
  priceFormat: {
    type: 'volume',
  },
});

candlestickSeries.setData(priceData);
volumeSeries.setData(volumeData);
```

---

### –†–µ—à–µ–Ω–∏–µ 3: –°–æ–∑–¥–∞—Ç—å volume –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π pane (v5.0+)

**–†–µ–π—Ç–∏–Ω–≥:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (9/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–í –≤–µ—Ä—Å–∏–∏ 5.0+ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å multi-pane –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è volume –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø–∞–Ω–µ–ª–∏.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è price –∏ volume
- –Ø—Å–Ω–∞—è –≤–∏–∑—É–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π pane

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –¢—Ä–µ–±—É–µ—Ç v5.0+
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ—Ç—É –≥—Ä–∞—Ñ–∏–∫–∞

```typescript
import { createChart, PriceScaleMode } from 'lightweight-charts';

const chart = createChart(container, {
  width: 800,
  height: 600, // –ë–æ–ª—å—à–µ –≤—ã—Å–æ—Ç—ã –¥–ª—è –¥–≤—É—Ö pane
});

// Pane 0: Candlestick —Å –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏–º –º–∞—Å—à—Ç–∞–±–æ–º
const candlestickSeries = chart.addCandlestickSeries({
  paneIndex: 0,
  priceScaleId: 'right',
});

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∞ –¥–ª—è pane 0
chart.priceScale('right').applyOptions({
  mode: PriceScaleMode.Logarithmic,
});

// Pane 1: Volume —Å –ª–∏–Ω–µ–π–Ω—ã–º –º–∞—Å—à—Ç–∞–±–æ–º
const volumeSeries = chart.addHistogramSeries({
  paneIndex: 1, // –û—Ç–¥–µ–ª—å–Ω–∞—è pane
  priceScaleId: 'volume-scale',
  color: '#26a69a',
  priceFormat: {
    type: 'volume',
  },
});

// Volume pane —Å –ª–∏–Ω–µ–π–Ω—ã–º –º–∞—Å—à—Ç–∞–±–æ–º
chart.priceScale('volume-scale').applyOptions({
  mode: PriceScaleMode.Normal,
});

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—ã—Å–æ—Ç—ã panes
chart.panes()[0].setHeight(450); // –¶–µ–Ω–∞
chart.panes()[1].setHeight(150); // Volume

candlestickSeries.setData(priceData);
volumeSeries.setData(volumeData);
```

---

### –†–µ—à–µ–Ω–∏–µ 4: –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∞

**–†–µ–π—Ç–∏–Ω–≥:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (7/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–°–æ–∑–¥–∞—Ç—å UI –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ –º–∞—Å—à—Ç–∞–±–∞, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –ª–∏–Ω–µ–π–Ω—ã–π —Ä–µ–∂–∏–º –¥–ª—è volume.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ì–∏–±–∫–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—Ä–∞–≤–Ω–∏—Ç—å log –∏ linear

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –¢—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ UI
- –ë–æ–ª—å—à–µ –∫–æ–¥–∞

```typescript
import { createChart, PriceScaleMode, IChartApi } from 'lightweight-charts';

interface ChartScaleConfig {
  priceMode: PriceScaleMode;
  volumeAlwaysLinear: boolean;
}

class ScalableChart {
  private chart: IChartApi;
  private candlestickSeries: ISeriesApi<'Candlestick'>;
  private volumeSeries: ISeriesApi<'Histogram'>;
  private config: ChartScaleConfig;

  constructor(container: HTMLElement, config: ChartScaleConfig) {
    this.config = config;

    this.chart = createChart(container, {
      width: 800,
      height: 500,
    });

    this.candlestickSeries = this.chart.addCandlestickSeries({
      priceScaleId: 'right',
    });

    this.volumeSeries = this.chart.addHistogramSeries({
      priceScaleId: 'volume',
      color: '#26a69a',
      priceFormat: { type: 'volume' },
    });

    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ volume scale
    this.volumeSeries.priceScale().applyOptions({
      scaleMargins: { top: 0.8, bottom: 0 },
      mode: PriceScaleMode.Normal, // –í—Å–µ–≥–¥–∞ –ª–∏–Ω–µ–π–Ω—ã–π
    });

    this.applyScaleConfig();
  }

  /**
   * –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –º–∞—Å—à—Ç–∞–±–∞ –¥–ª—è —Ü–µ–Ω
   */
  setPriceScaleMode(mode: PriceScaleMode): void {
    this.config.priceMode = mode;
    this.applyScaleConfig();
  }

  /**
   * –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –º–µ–∂–¥—É log –∏ linear
   */
  toggleLogarithmic(): void {
    const newMode =
      this.config.priceMode === PriceScaleMode.Logarithmic
        ? PriceScaleMode.Normal
        : PriceScaleMode.Logarithmic;
    this.setPriceScaleMode(newMode);
  }

  /**
   * –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º
   */
  isLogarithmic(): boolean {
    return this.config.priceMode === PriceScaleMode.Logarithmic;
  }

  private applyScaleConfig(): void {
    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ä–µ–∂–∏–º –∫ —Ü–µ–Ω–æ–≤–æ–π —à–∫–∞–ª–µ
    this.chart.priceScale('right').applyOptions({
      mode: this.config.priceMode,
    });

    // Volume –í–°–ï–ì–î–ê –æ—Å—Ç–∞—ë—Ç—Å—è –ª–∏–Ω–µ–π–Ω—ã–º
    if (this.config.volumeAlwaysLinear) {
      this.volumeSeries.priceScale().applyOptions({
        mode: PriceScaleMode.Normal,
      });
    }
  }

  setData(
    priceData: CandlestickData<Time>[],
    volumeData: HistogramData<Time>[]
  ): void {
    this.candlestickSeries.setData(priceData);
    this.volumeSeries.setData(volumeData);
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const chart = new ScalableChart(container, {
  priceMode: PriceScaleMode.Logarithmic,
  volumeAlwaysLinear: true,
});

// UI toggle button
document.getElementById('toggleLog')?.addEventListener('click', () => {
  chart.toggleLogarithmic();
  updateButtonLabel();
});
```

---

### –†–µ—à–µ–Ω–∏–µ 5: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è volume –¥–∞–Ω–Ω—ã—Ö –¥–ª—è log-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

**–†–µ–π—Ç–∏–Ω–≥:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ï—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É —à–∫–∞–ª—É, –º–æ–∂–Ω–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å volume –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ log scale.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è scales
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö use cases

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –ò—Å–∫–∞–∂–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è volume
- –¢—Ä–µ–±—É–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production

```typescript
/**
 * –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è volume –¥–ª—è log-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
 * –ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ scales
 */
function normalizeVolumeForLogScale(
  volumeData: HistogramData<Time>[],
  priceData: CandlestickData<Time>[]
): HistogramData<Time>[] {
  // –í—ã—á–∏—Å–ª—è–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω—ã
  const prices = priceData.flatMap((d) => [d.open, d.high, d.low, d.close]);
  const minPrice = Math.min(...prices);
  const maxPrice = Math.max(...prices);
  const priceRange = maxPrice - minPrice;

  const volumes = volumeData.map((d) => d.value ?? 0);
  const maxVolume = Math.max(...volumes);

  // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º volume –∫ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ price range
  const volumeScaleFactor = (priceRange * 0.15) / maxVolume;
  const volumeOffset = minPrice;

  return volumeData.map((d) => ({
    ...d,
    value: d.value ? d.value * volumeScaleFactor + volumeOffset : undefined,
  }));
}

// –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ —Ö–∞–∫, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ scales!
```

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –†–µ—à–µ–Ω–∏–µ 1: –û—Ç–¥–µ–ª—å–Ω–∞—è overlay scale –¥–ª—è volume

–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∏ —Å–∞–º—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–æ—Ç–¥–µ–ª—å–Ω—É—é overlay price scale** –¥–ª—è volume series:

```typescript
import {
  createChart,
  IChartApi,
  ISeriesApi,
  PriceScaleMode,
  CandlestickData,
  HistogramData,
  Time,
  ColorType,
} from 'lightweight-charts';

// ============================================
// 1. –¢–∏–ø—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
// ============================================

interface VolumeChartConfig {
  container: HTMLElement;
  width?: number;
  height?: number;
  volumeHeightPercent?: number; // 0.1 = 10%
  useLogarithmicPrice?: boolean;
  volumeColors?: {
    up: string;
    down: string;
  };
}

// ============================================
// 2. –ö–ª–∞—Å—Å –≥—Ä–∞—Ñ–∏–∫–∞ —Å —Ä–∞–∑–¥–µ–ª—å–Ω—ã–º–∏ –º–∞—Å—à—Ç–∞–±–∞–º–∏
// ============================================

class PriceVolumeChart {
  private chart: IChartApi;
  private priceSeries: ISeriesApi<'Candlestick'>;
  private volumeSeries: ISeriesApi<'Histogram'>;
  private config: Required<VolumeChartConfig>;

  constructor(config: VolumeChartConfig) {
    this.config = {
      container: config.container,
      width: config.width ?? 800,
      height: config.height ?? 500,
      volumeHeightPercent: config.volumeHeightPercent ?? 0.15,
      useLogarithmicPrice: config.useLogarithmicPrice ?? false,
      volumeColors: config.volumeColors ?? {
        up: '#26a69a',
        down: '#ef5350',
      },
    };

    this.chart = this.createChart();
    this.priceSeries = this.createPriceSeries();
    this.volumeSeries = this.createVolumeSeries();
  }

  private createChart(): IChartApi {
    return createChart(this.config.container, {
      width: this.config.width,
      height: this.config.height,
      layout: {
        background: { type: ColorType.Solid, color: '#1e222d' },
        textColor: '#d1d4dc',
      },
      grid: {
        vertLines: { color: '#2B2B43' },
        horzLines: { color: '#2B2B43' },
      },
      rightPriceScale: {
        mode: this.config.useLogarithmicPrice
          ? PriceScaleMode.Logarithmic
          : PriceScaleMode.Normal,
        visible: true,
        borderColor: '#2B2B43',
      },
      // Overlay scales (–¥–ª—è volume) - –í–°–ï–ì–î–ê –ª–∏–Ω–µ–π–Ω—ã–π
      overlayPriceScales: {
        mode: PriceScaleMode.Normal,
      },
      timeScale: {
        borderColor: '#2B2B43',
        timeVisible: true,
        secondsVisible: false,
      },
      crosshair: {
        mode: 1, // CrosshairMode.Normal
      },
    });
  }

  private createPriceSeries(): ISeriesApi<'Candlestick'> {
    return this.chart.addCandlestickSeries({
      priceScaleId: 'right',
      upColor: '#26a69a',
      downColor: '#ef5350',
      borderDownColor: '#ef5350',
      borderUpColor: '#26a69a',
      wickDownColor: '#ef5350',
      wickUpColor: '#26a69a',
    });
  }

  private createVolumeSeries(): ISeriesApi<'Histogram'> {
    const volumeMarginTop = 1 - this.config.volumeHeightPercent;

    const series = this.chart.addHistogramSeries({
      priceScaleId: 'volume', // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID = –æ—Ç–¥–µ–ª—å–Ω–∞—è overlay scale
      color: this.config.volumeColors.up,
      priceFormat: {
        type: 'volume',
      },
      priceLineVisible: false,
      lastValueVisible: false,
    });

    // –ö—Ä–∏—Ç–∏—á–Ω–æ: –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –ª–∏–Ω–µ–π–Ω—ã–π –º–∞—Å—à—Ç–∞–± –¥–ª—è volume
    series.priceScale().applyOptions({
      scaleMargins: {
        top: volumeMarginTop,
        bottom: 0,
      },
      mode: PriceScaleMode.Normal, // –í–°–ï–ì–î–ê –ª–∏–Ω–µ–π–Ω—ã–π!
    });

    return series;
  }

  /**
   * –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π colorization volume
   */
  setData(
    priceData: CandlestickData<Time>[],
    volumeData?: HistogramData<Time>[]
  ): void {
    this.priceSeries.setData(priceData);

    if (volumeData) {
      // Colorize volume based on price direction
      const colorizedVolume = this.colorizeVolume(priceData, volumeData);
      this.volumeSeries.setData(colorizedVolume);
    }
  }

  /**
   * –û–±–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞—Ä
   */
  update(
    priceBar: CandlestickData<Time>,
    volumeBar?: HistogramData<Time>
  ): void {
    this.priceSeries.update(priceBar);

    if (volumeBar) {
      const color =
        priceBar.close >= priceBar.open
          ? this.config.volumeColors.up
          : this.config.volumeColors.down;
      this.volumeSeries.update({ ...volumeBar, color });
    }
  }

  /**
   * –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º –¥–ª—è —Ü–µ–Ω
   */
  setLogarithmic(enabled: boolean): void {
    this.config.useLogarithmicPrice = enabled;

    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –∫ —Ü–µ–Ω–æ–≤–æ–π —à–∫–∞–ª–µ
    this.chart.priceScale('right').applyOptions({
      mode: enabled ? PriceScaleMode.Logarithmic : PriceScaleMode.Normal,
    });

    // Volume –æ—Å—Ç–∞—ë—Ç—Å—è –ª–∏–Ω–µ–π–Ω—ã–º
    this.volumeSeries.priceScale().applyOptions({
      mode: PriceScaleMode.Normal,
    });
  }

  /**
   * –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º
   */
  isLogarithmic(): boolean {
    return this.config.useLogarithmicPrice;
  }

  /**
   * –ü–æ–ª—É—á–∏—Ç—å API –≥—Ä–∞—Ñ–∏–∫–∞
   */
  getChart(): IChartApi {
    return this.chart;
  }

  /**
   * –£–¥–∞–ª–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫
   */
  remove(): void {
    this.chart.remove();
  }

  private colorizeVolume(
    priceData: CandlestickData<Time>[],
    volumeData: HistogramData<Time>[]
  ): HistogramData<Time>[] {
    const priceMap = new Map(
      priceData.map((p) => [String(p.time), p])
    );

    return volumeData.map((v) => {
      const price = priceMap.get(String(v.time));
      const color =
        price && price.close >= price.open
          ? this.config.volumeColors.up
          : this.config.volumeColors.down;
      return { ...v, color };
    });
  }
}

// ============================================
// 3. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
// ============================================

function createPriceVolumeChart(): void {
  const container = document.getElementById('chart')!;

  const chart = new PriceVolumeChart({
    container,
    width: 900,
    height: 500,
    volumeHeightPercent: 0.2, // Volume –∑–∞–Ω–∏–º–∞–µ—Ç 20% –≤—ã—Å–æ—Ç—ã
    useLogarithmicPrice: true, // –¶–µ–Ω—ã –≤ log scale
    volumeColors: {
      up: '#26a69a',
      down: '#ef5350',
    },
  });

  // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
  const priceData: CandlestickData<Time>[] = [
    { time: '2024-01-01', open: 100, high: 105, low: 98, close: 103 },
    { time: '2024-01-02', open: 103, high: 110, low: 102, close: 108 },
    { time: '2024-01-03', open: 108, high: 112, low: 106, close: 107 },
    // ... more data
  ];

  const volumeData: HistogramData<Time>[] = [
    { time: '2024-01-01', value: 1000000 },
    { time: '2024-01-02', value: 1500000 },
    { time: '2024-01-03', value: 800000 },
    // ... more data
  ];

  chart.setData(priceData, volumeData);

  // Toggle button
  document.getElementById('toggleLog')?.addEventListener('click', () => {
    chart.setLogarithmic(!chart.isLogarithmic());
  });
}

export { PriceVolumeChart, VolumeChartConfig };
```

### –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –û—Ü–µ–Ω–∫–∞ |
|----------|--------|
| **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å** | ‚úÖ Volume –≤—Å–µ–≥–¥–∞ –≤ –ª–∏–Ω–µ–π–Ω–æ–º –º–∞—Å—à—Ç–∞–±–µ |
| **–ì–∏–±–∫–æ—Å—Ç—å** | ‚úÖ –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π —à–∫–∞–ª–æ–π |
| **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å v4.0+ |
| **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** | ‚úÖ –ß–∏—Å—Ç—ã–π API |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | ‚úÖ –ù–∞—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ |

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ—à–µ–Ω–∏–π

| –†–µ—à–µ–Ω–∏–µ | –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | –†–µ–π—Ç–∏–Ω–≥ |
|---------|--------------|-----------|---------------|---------|
| #1: Overlay scale | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –ù–∏–∑–∫–∞—è | v3.0+ | 10/10 |
| #2: –õ–µ–≤–∞—è —à–∫–∞–ª–∞ | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –ù–∏–∑–∫–∞—è | –í—Å–µ –≤–µ—Ä—Å–∏–∏ | 9/10 |
| #3: Multi-pane | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –°—Ä–µ–¥–Ω—è—è | v5.0+ | 9/10 |
| #4: –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ | ‚≠ê‚≠ê‚≠ê‚≠ê | –°—Ä–µ–¥–Ω—è—è | –í—Å–µ –≤–µ—Ä—Å–∏–∏ | 7/10 |
| #5: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö | ‚≠ê‚≠ê | –í—ã—Å–æ–∫–∞—è | –í—Å–µ –≤–µ—Ä—Å–∏–∏ | 5/10 |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É

- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π** ‚Üí –†–µ—à–µ–Ω–∏–µ #1 (Overlay scale)
- **–ù—É–∂–Ω—ã –≤–∏–¥–∏–º—ã–µ –º–µ—Ç–∫–∏ volume** ‚Üí –†–µ—à–µ–Ω–∏–µ #2 (–õ–µ–≤–∞—è —à–∫–∞–ª–∞)
- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç (v5.0+)** ‚Üí –†–µ—à–µ–Ω–∏–µ #3 (Multi-pane)
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ** ‚Üí –†–µ—à–µ–Ω–∏–µ #4

---

## üîó –ò—Å—Ç–æ—á–Ω–∏–∫–∏

1. **GitHub Issue #227** ‚Äî [Logarithmic scaling is applied to volume](https://github.com/tradingview/lightweight-charts/issues/227)

2. **Release Notes v4.2.0** ‚Äî [Fixed: Logarithmic scale for volume](https://tradingview.github.io/lightweight-charts/docs/release-notes)

3. **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: Price Scales** ‚Äî [Multiple Price Scales](https://tradingview.github.io/lightweight-charts/docs/price-scale)

4. **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: PriceScaleMode** ‚Äî [API Reference](https://tradingview.github.io/lightweight-charts/docs/api/enums/PriceScaleMode)

5. **How-To: Volume on Chart** ‚Äî [Adding Volume](https://tradingview.github.io/lightweight-charts/tutorials/how_to/volume-on-chart)

6. **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: Multi-Pane (v5.0+)** ‚Äî [Panes](https://tradingview.github.io/lightweight-charts/docs/panes)

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** 2026-01-18  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0  
**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ë–∞–≥ –±—ã–ª –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –≤ v1.2.1, –Ω–æ –æ—Å—Ç–∞—ë—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –∫–∞–∫ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ volume —Å –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏–º–∏ —Ü–µ–Ω–∞–º–∏.

# –ë–ê–ì #39: –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª—ã

> **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° –°–†–ï–î–ù–Ø–Ø  
> **Issue:** [#1809](https://github.com/tradingview/lightweight-charts/issues/1809)  
> **–í–µ—Ä—Å–∏–∏:** –í—Å–µ –≤–µ—Ä—Å–∏–∏  
> **–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è Working as Intended (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å)

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –°—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
–ü—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –±–æ–ª—å—à–∏—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–∞—Å—à—Ç–∞–±–∞—Ö (1 –º–µ—Å—è—Ü, 1 –≥–æ–¥) –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è **–Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —à–∏—Ä–∏–Ω—ã –±–∞—Ä–æ–≤ –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ —Ç–∏–∫–æ–≤** –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª–µ. –î–∞–∂–µ –ø—Ä–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Å —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏, –≥—Ä–∞—Ñ–∏–∫ –º–æ–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ç–∏–∫–∏ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏.

### –ü—Ä–æ—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã

1. **–ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã —Ç–∏–∫–æ–≤:**
   - –ú–µ—Å—è—á–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∏–∫–∏ —Å 4-–¥–Ω–µ–≤–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏
   - –ó–∞—Ç–µ–º –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ 6-–¥–Ω–µ–≤–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –±–µ–∑ –≤–∏–¥–∏–º–æ–π –ø—Ä–∏—á–∏–Ω—ã

2. **–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –±–∞—Ä–æ–≤:**
   - –ë–∞—Ä—ã –Ω–∞ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ –∏–º–µ—é—Ç —Ä–∞–∑–Ω—É—é –≤–∏–∑—É–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É
   - –û—Å–æ–±–µ–Ω–Ω–æ –∑–∞–º–µ—Ç–Ω–æ –Ω–∞ –∫—Ä–∞—è—Ö –≥—Ä–∞—Ñ–∏–∫–∞

3. **–ü—Ä–æ–±–ª–µ–º—ã —Å –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º:**
   - –ú–µ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ –≤—Å–µ–≥–¥–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ü–µ–Ω—Ç—Ä—É –±–∞—Ä–∞
   - –ü—Ä–∏ zoom –≤–∏–∑—É–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –±–∞—Ä–æ–≤ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –Ω–µ–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

Lightweight Charts –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–µ–∫—Å** –¥–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

```
–õ–æ–≥–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–µ–∫—Å:  0    1    2    3    4    ...
–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è:     Jan  Feb  Mar  Apr  May  ...
                    ‚Üë    ‚Üë    ‚Üë    ‚Üë    ‚Üë
                  –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
```

–ü—Ä–∏ —ç—Ç–æ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å, –Ω–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –≤–∏–∑—É–∞–ª—å–Ω–æ–π –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏.

### –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

- –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Å –±–æ–ª—å—à–∏–º–∏ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º–∏ (1M, 1Y)
- –î–∞–Ω–Ω—ã–µ —Å –Ω–µ—Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–µ—Ä–∏–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤

---

## üîç –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö (‚≠ê 7/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã—Ö —Ç–æ—á–µ–∫ –∫—Ä–∞—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, 7) –ø–æ–º–æ–≥–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–∏–∫–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –£–ª—É—á—à–∞–µ—Ç —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å —Ç–∏–∫–æ–≤
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ú–æ–∂–µ—Ç –æ–±—Ä–µ–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
- ‚ùå –ù–µ –≤—Å–µ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω–∏–º–æ
- ‚ùå "–ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞" –≤ –∫–æ–¥–µ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
function adjustDataPointsCount(data, multiple = 7) {
    const targetLength = Math.floor(data.length / multiple) * multiple;
    
    if (targetLength === 0) {
        return data;
    }
    
    // –û—Å—Ç–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ targetLength —Ç–æ—á–µ–∫
    return data.slice(-targetLength);
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const rawData = fetchMonthlyData();
const adjustedData = adjustDataPointsCount(rawData, 7);
series.setData(adjustedData);
```

---

### –†–µ—à–µ–Ω–∏–µ 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ padding –∫ —à–∏—Ä–∏–Ω–µ –≥—Ä–∞—Ñ–∏–∫–∞ (‚≠ê 6/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ padding –∫ —Ä–∞–∑–º–µ—Ä–∞–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≥—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —à–∏—Ä–∏–Ω—ã, –∫—Ä–∞—Ç–Ω–æ–π –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ú–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å
- ‚úÖ –õ–µ–≥–∫–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ CSS

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –í–ª–∏—è–µ—Ç –Ω–∞ layout —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –ø—Ä–∏ resize

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
function calculateOptimalWidth(containerWidth, barCount, targetSpacing = 7) {
    const idealWidth = barCount * targetSpacing;
    const multiple = Math.ceil(containerWidth / targetSpacing) * targetSpacing;
    
    return Math.max(containerWidth, multiple);
}

// –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —à–∏—Ä–∏–Ω–æ–π
function createOptimizedChart(container, data) {
    const optimalWidth = calculateOptimalWidth(
        container.clientWidth,
        data.length,
        7
    );
    
    const chart = createChart(container, {
        width: optimalWidth,
        height: 400,
    });
    
    // –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
    const padding = (optimalWidth - container.clientWidth) / 2;
    if (padding > 0) {
        container.style.marginLeft = `-${padding}px`;
        container.style.overflow = 'hidden';
    }
    
    return chart;
}
```

---

### –†–µ—à–µ–Ω–∏–µ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∏–∫–∞–º–∏ (‚≠ê 8/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `barSpacing` –∏ `logicalRange` –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª—ã –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–µ—Ç–æ–∫.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º
- ‚úÖ –ù–∞—Ç–∏–≤–Ω—ã–π API –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –≤–µ—Ä—Å–∏—è—Ö

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è internal mechanics
- ‚ùå –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –ø–æ–¥—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ —ç–∫—Ä–∞–Ω–∞

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
import { createChart } from 'lightweight-charts';

class TimeScaleManager {
    constructor(chart) {
        this.chart = chart;
        this.timeScale = chart.timeScale();
    }

    /**
     * –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ barSpacing –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
     */
    configureOptimalSpacing(dataLength, targetVisibleBars) {
        const chartWidth = this.chart.options().width;
        const optimalSpacing = chartWidth / targetVisibleBars;
        
        this.timeScale.applyOptions({
            barSpacing: Math.max(optimalSpacing, 1),
            rightOffset: 5,
        });
    }

    /**
     * –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–∏–¥–∏–º–æ–≥–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
     */
    setVisibleRange(startIndex, endIndex) {
        this.timeScale.setVisibleLogicalRange({
            from: startIndex,
            to: endIndex,
        });
    }

    /**
     * –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
     */
    subscribeRangeChange(callback) {
        return this.timeScale.subscribeVisibleLogicalRangeChange((range) => {
            if (range) {
                callback({
                    from: Math.round(range.from),
                    to: Math.round(range.to),
                    barsCount: Math.round(range.to - range.from),
                });
            }
        });
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const chart = createChart(container, { width: 800, height: 400 });
const manager = new TimeScaleManager(chart);

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ~100 –±–∞—Ä–æ–≤
manager.configureOptimalSpacing(data.length, 100);
```

---

### –†–µ—à–µ–Ω–∏–µ 4: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ—Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π (‚≠ê 8/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–Ω–µ–π –∏ –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤ –∏–∑ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∏—Ö –≤–ª–∏—è–Ω–∏—è –Ω–∞ —Ä–∞—Å—á—ë—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ —Ç–∏–∫–æ–≤.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –£–ª—É—á—à–∞–µ—Ç –æ–±—â–∏–π –≤–∏–¥ –≥—Ä–∞—Ñ–∏–∫–∞
- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –≤ trading apps

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ –¥–ª—è 24/7 –¥–∞–Ω–Ω—ã—Ö (–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã)
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –∑–Ω–∞–Ω–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –¥–Ω–µ–π
- ‚ùå –ú–æ–∂–µ—Ç –∑–∞–ø—É—Ç–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
/**
 * –§–∏–ª—å—Ç—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ, –∏—Å–∫–ª—é—á–∞—è –Ω–µ—Ä–∞–±–æ—á–∏–µ –¥–Ω–∏
 */
function filterTradingDays(data, options = {}) {
    const {
        excludeWeekends = true,
        holidays = [],  // –ú–∞—Å—Å–∏–≤ –¥–∞—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ 'YYYY-MM-DD'
    } = options;

    const holidaySet = new Set(holidays);

    return data.filter(point => {
        const date = new Date(point.time * 1000 || point.time);
        const dayOfWeek = date.getUTCDay();
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö
        if (excludeWeekends && (dayOfWeek === 0 || dayOfWeek === 6)) {
            return false;
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤
        const dateStr = date.toISOString().split('T')[0];
        if (holidaySet.has(dateStr)) {
            return false;
        }
        
        return true;
    });
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const rawData = fetchStockData();
const tradingDaysOnly = filterTradingDays(rawData, {
    excludeWeekends: true,
    holidays: ['2024-01-01', '2024-12-25'], // –ü—Ä–∞–∑–¥–Ω–∏–∫–∏
});

series.setData(tradingDaysOnly);
```

---

### –†–µ—à–µ–Ω–∏–µ 5: Whitespace Data –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–±–µ–ª–æ–≤ (‚≠ê 9/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–°–æ–∑–¥–∞–Ω–∏–µ "whitespace" –¥–∞–Ω–Ω—ã—Ö (—Ç–æ—á–∫–∏ —Ç–æ–ª—å–∫–æ —Å –≤—Ä–µ–º–µ–Ω–µ–º, –±–µ–∑ –∑–Ω–∞—á–µ–Ω–∏—è) –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª–µ.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø—Ä–æ–±–µ–ª—ã –≤ –¥–∞–Ω–Ω—ã—Ö

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
- ‚ùå –ú–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–±–µ–ª–æ–≤

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
import { createChart } from 'lightweight-charts';

/**
 * –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä whitespace –¥–∞–Ω–Ω—ã—Ö
 */
class WhitespaceGenerator {
    /**
     * –°–æ–∑–¥–∞—ë—Ç –º–∞—Å—Å–∏–≤ whitespace —Ç–æ—á–µ–∫ –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
     * @param {number} startTime - –ù–∞—á–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (Unix timestamp)
     * @param {number} endTime - –ö–æ–Ω–µ—á–Ω–æ–µ –≤—Ä–µ–º—è (Unix timestamp)
     * @param {number} intervalSeconds - –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
     */
    static generateTimeRange(startTime, endTime, intervalSeconds) {
        const points = [];
        let currentTime = startTime;

        while (currentTime <= endTime) {
            points.push({ time: currentTime });
            currentTime += intervalSeconds;
        }

        return points;
    }

    /**
     * –ó–∞–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã –≤ –¥–∞–Ω–Ω—ã—Ö whitespace —Ç–æ—á–∫–∞–º–∏
     * @param {Array} data - –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
     * @param {number} expectedInterval - –û–∂–∏–¥–∞–µ–º—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏
     */
    static fillGaps(data, expectedInterval) {
        if (data.length < 2) return data;

        const result = [];
        
        for (let i = 0; i < data.length; i++) {
            result.push(data[i]);

            if (i < data.length - 1) {
                const currentTime = data[i].time;
                const nextTime = data[i + 1].time;
                const gap = nextTime - currentTime;

                // –ï—Å–ª–∏ –ø—Ä–æ–±–µ–ª –±–æ–ª—å—à–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
                if (gap > expectedInterval * 1.5) {
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º whitespace —Ç–æ—á–∫–∏
                    let fillTime = currentTime + expectedInterval;
                    while (fillTime < nextTime) {
                        result.push({ time: fillTime });
                        fillTime += expectedInterval;
                    }
                }
            }
        }

        return result;
    }

    /**
     * –û–±—ä–µ–¥–∏–Ω—è–µ—Ç whitespace —Å–µ—Ä–∏—é —Å –¥–∞–Ω–Ω—ã–º–∏
     */
    static mergeWithWhitespace(data, whitespaceData) {
        // –°–æ–∑–¥–∞—ë–º Map –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
        const dataMap = new Map(data.map(d => [d.time, d]));
        
        // –û–±—ä–µ–¥–∏–Ω—è–µ–º
        return whitespaceData.map(ws => dataMap.get(ws.time) || ws);
    }
}

// ============ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ============

const chart = createChart(container, {
    width: 800,
    height: 400,
    timeScale: {
        timeVisible: true,
        secondsVisible: false,
    },
});

const lineSeries = chart.addLineSeries({
    color: '#2962FF',
    lineWidth: 2,
});

// –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ–±–µ–ª–∞–º–∏
const rawData = [
    { time: 1704067200, value: 100 }, // 2024-01-01
    { time: 1704153600, value: 102 }, // 2024-01-02
    // –ü—Ä–æ–±–µ–ª: 2024-01-03 - 2024-01-05
    { time: 1704499200, value: 105 }, // 2024-01-06
    { time: 1704585600, value: 103 }, // 2024-01-07
];

const SECONDS_IN_DAY = 86400;

// –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–±–µ–ª—ã
const filledData = WhitespaceGenerator.fillGaps(rawData, SECONDS_IN_DAY);
lineSeries.setData(filledData);

// –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å –≤–∏–¥–∏–º—ã–º–∏ –ø—Ä–æ–±–µ–ª–∞–º–∏
```

---

### –†–µ—à–µ–Ω–∏–µ 6: –ö–∞—Å—Ç–æ–º–Ω—ã–π tickMarkFormatter (‚≠ê 7/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä–∞ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ñ–æ—Ä–º–∞—Ç–æ–º
- ‚úÖ –ú–æ–∂–Ω–æ —Å–∫—Ä—ã–≤–∞—Ç—å "–ª–∏—à–Ω–∏–µ" –º–µ—Ç–∫–∏
- ‚úÖ –ù–∞—Ç–∏–≤–Ω—ã–π API

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ù–µ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
- ‚ùå –¢–æ–ª—å–∫–æ –∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ
- ‚ùå –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ "—É–º–Ω–æ–≥–æ" —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä–∞

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
import { createChart, TickMarkType } from 'lightweight-charts';

/**
 * –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä –º–µ—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏ —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
 */
function createSmartTickFormatter(options = {}) {
    const {
        yearFormat = 'YYYY',
        monthFormat = 'MMM',
        dayFormat = 'DD',
        minLabelSpacing = 50, // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –º–µ—Ç–∫–∞–º–∏ –≤ px
    } = options;

    let lastDrawnTickTime = 0;
    let lastDrawnTickX = -Infinity;

    return (time, tickMarkType, locale) => {
        const date = new Date(time * 1000);
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ–æ—Ä–º–∞—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ç–∏–∫–∞
        let format;
        
        switch (tickMarkType) {
            case TickMarkType.Year:
                format = date.getFullYear().toString();
                break;
            case TickMarkType.Month:
                format = date.toLocaleString(locale, { month: 'short' });
                break;
            case TickMarkType.DayOfMonth:
                format = date.getDate().toString();
                break;
            case TickMarkType.Time:
                format = date.toLocaleTimeString(locale, { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                break;
            case TickMarkType.TimeWithSeconds:
                format = date.toLocaleTimeString(locale);
                break;
            default:
                format = '';
        }
        
        return format;
    };
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const chart = createChart(container, {
    width: 800,
    height: 400,
    timeScale: {
        tickMarkFormatter: createSmartTickFormatter(),
        timeVisible: true,
    },
});
```

---

### –†–µ—à–µ–Ω–∏–µ 7: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ (‚≠ê 8/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–î–ª—è multi-chart layouts –≤–∞–∂–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∫–∞–ª—ã –º–µ–∂–¥—É –≥—Ä–∞—Ñ–∏–∫–∞–º–∏.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–π UX
- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è trading apps
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å
- ‚ùå –í–æ–∑–º–æ–∂–Ω—ã –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ü–∏–∫–ª—ã –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
import { createChart } from 'lightweight-charts';

/**
 * –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∫–∞–ª
 */
class TimeScaleSyncManager {
    constructor() {
        this.charts = new Map();
        this.isSyncing = false;
    }

    /**
     * –î–æ–±–∞–≤–ª—è–µ—Ç –≥—Ä–∞—Ñ–∏–∫ –≤ –≥—Ä—É–ø–ø—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
     */
    addChart(id, chart) {
        this.charts.set(id, chart);
        this._setupListener(id, chart);
    }

    /**
     * –£–¥–∞–ª—è–µ—Ç –≥—Ä–∞—Ñ–∏–∫ –∏–∑ –≥—Ä—É–ø–ø—ã
     */
    removeChart(id) {
        this.charts.delete(id);
    }

    _setupListener(sourceId, sourceChart) {
        sourceChart.timeScale().subscribeVisibleLogicalRangeChange((range) => {
            if (this.isSyncing || !range) return;

            this.isSyncing = true;

            try {
                this.charts.forEach((chart, id) => {
                    if (id !== sourceId) {
                        chart.timeScale().setVisibleLogicalRange(range);
                    }
                });
            } finally {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º setTimeout –¥–ª—è —Å–±—Ä–æ—Å–∞ —Ñ–ª–∞–≥–∞ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
                setTimeout(() => {
                    this.isSyncing = false;
                }, 0);
            }
        });
    }

    /**
     * –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –¥–∏–∞–ø–∞–∑–æ–Ω—É
     */
    syncToRange(range) {
        this.isSyncing = true;
        
        try {
            this.charts.forEach(chart => {
                chart.timeScale().setVisibleLogicalRange(range);
            });
        } finally {
            setTimeout(() => {
                this.isSyncing = false;
            }, 0);
        }
    }

    /**
     * –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
     */
    fitAllContent() {
        this.charts.forEach(chart => {
            chart.timeScale().fitContent();
        });
    }
}

// ============ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ============

const syncManager = new TimeScaleSyncManager();

// –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
const chart1 = createChart(document.getElementById('chart1'), {
    width: 800, height: 300
});
const chart2 = createChart(document.getElementById('chart2'), {
    width: 800, height: 200
});
const chart3 = createChart(document.getElementById('chart3'), {
    width: 800, height: 200
});

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
syncManager.addChart('main', chart1);
syncManager.addChart('volume', chart2);
syncManager.addChart('indicator', chart3);

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
chart1.addCandlestickSeries().setData(priceData);
chart2.addHistogramSeries().setData(volumeData);
chart3.addLineSeries().setData(rsiData);

// –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
syncManager.fitAllContent();
```

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥: Whitespace Data + –ù–∞—Å—Ç—Ä–æ–π–∫–∞ TimeScale

–î–ª—è –Ω–∞–¥—ë–∂–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –ø–æ–¥—Ö–æ–¥–æ–≤:

```javascript
import { createChart } from 'lightweight-charts';

/**
 * –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª—ã
 * –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑:
 * 1. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–µ–ª–æ–≤ whitespace –¥–∞–Ω–Ω—ã–º–∏
 * 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –Ω–∞—Å—Ç—Ä–æ–µ–∫ timeScale
 * 3. –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–∏–¥–∏–º–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
 */
class ConsistentTimeScaleManager {
    constructor(chart, options = {}) {
        this.chart = chart;
        this.timeScale = chart.timeScale();
        
        this.options = {
            expectedIntervalSeconds: options.expectedIntervalSeconds || 86400, // 1 –¥–µ–Ω—å
            excludeWeekends: options.excludeWeekends ?? true,
            holidays: options.holidays || [],
            minBarSpacing: options.minBarSpacing || 6,
            targetVisibleBars: options.targetVisibleBars || 100,
        };
    }

    /**
     * –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª—ã
     */
    prepareData(rawData) {
        if (!rawData || rawData.length === 0) return [];

        // –®–∞–≥ 1: –§–∏–ª—å—Ç—Ä—É–µ–º –Ω–µ—Ä–∞–±–æ—á–∏–µ –¥–Ω–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        let processedData = this.options.excludeWeekends
            ? this._filterNonTradingDays(rawData)
            : rawData;

        // –®–∞–≥ 2: –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–±–µ–ª—ã whitespace –¥–∞–Ω–Ω—ã–º–∏
        processedData = this._fillGapsWithWhitespace(processedData);

        return processedData;
    }

    /**
     * –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª—ã
     */
    configureTimeScale() {
        const chartWidth = this.chart.options().width;
        const optimalSpacing = Math.max(
            chartWidth / this.options.targetVisibleBars,
            this.options.minBarSpacing
        );

        this.timeScale.applyOptions({
            barSpacing: optimalSpacing,
            minBarSpacing: this.options.minBarSpacing,
            rightOffset: 5,
            lockVisibleTimeRangeOnResize: true,
            timeVisible: true,
            secondsVisible: false,
            tickMarkFormatter: this._createTickFormatter(),
        });
    }

    /**
     * –§–∏–ª—å—Ç—Ä—É–µ—Ç –≤—ã—Ö–æ–¥–Ω—ã–µ –∏ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏
     */
    _filterNonTradingDays(data) {
        const holidaySet = new Set(this.options.holidays);

        return data.filter(point => {
            const timestamp = typeof point.time === 'number' 
                ? point.time 
                : new Date(point.time).getTime() / 1000;
            
            const date = new Date(timestamp * 1000);
            const dayOfWeek = date.getUTCDay();
            
            if (dayOfWeek === 0 || dayOfWeek === 6) {
                return false;
            }
            
            const dateStr = date.toISOString().split('T')[0];
            return !holidaySet.has(dateStr);
        });
    }

    /**
     * –ó–∞–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã whitespace –¥–∞–Ω–Ω—ã–º–∏
     */
    _fillGapsWithWhitespace(data) {
        if (data.length < 2) return data;

        const result = [];
        const interval = this.options.expectedIntervalSeconds;
        const threshold = interval * 1.5;

        for (let i = 0; i < data.length; i++) {
            result.push(data[i]);

            if (i < data.length - 1) {
                const currentTime = this._normalizeTime(data[i].time);
                const nextTime = this._normalizeTime(data[i + 1].time);
                const gap = nextTime - currentTime;

                if (gap > threshold) {
                    let fillTime = currentTime + interval;
                    
                    while (fillTime < nextTime) {
                        // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –≤—ã—Ö–æ–¥–Ω—ã–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                        if (!this.options.excludeWeekends || 
                            !this._isWeekend(fillTime)) {
                            result.push({ time: fillTime });
                        }
                        fillTime += interval;
                    }
                }
            }
        }

        return result;
    }

    _normalizeTime(time) {
        if (typeof time === 'number') return time;
        return Math.floor(new Date(time).getTime() / 1000);
    }

    _isWeekend(timestamp) {
        const day = new Date(timestamp * 1000).getUTCDay();
        return day === 0 || day === 6;
    }

    _createTickFormatter() {
        return (time, tickMarkType, locale) => {
            const date = new Date(time * 1000);
            
            // –£–ø—Ä–æ—â—ë–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
            const formatters = {
                0: () => date.getFullYear().toString(), // Year
                1: () => date.toLocaleString(locale, { month: 'short' }), // Month
                2: () => date.getDate().toString(), // Day
                3: () => date.toLocaleTimeString(locale, { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                }),
            };
            
            return (formatters[tickMarkType] || (() => ''))();
        };
    }

    /**
     * –ü—Ä–∏–º–µ–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫ —Å–µ—Ä–∏–∏ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
     */
    applyToSeries(series, rawData) {
        const preparedData = this.prepareData(rawData);
        series.setData(preparedData);
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —à–∫–∞–ª—É –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        this.configureTimeScale();
        
        // –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≤–∏–¥–∏–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
        this.timeScale.fitContent();
        
        return preparedData;
    }
}

// ============ –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ============

const container = document.getElementById('chart');

const chart = createChart(container, {
    width: 1000,
    height: 500,
    layout: {
        background: { type: 'solid', color: '#1e222d' },
        textColor: '#d1d4dc',
    },
    grid: {
        vertLines: { color: 'rgba(42, 46, 57, 0.5)' },
        horzLines: { color: 'rgba(42, 46, 57, 0.5)' },
    },
});

const candleSeries = chart.addCandlestickSeries({
    upColor: '#26a69a',
    downColor: '#ef5350',
    borderVisible: false,
    wickUpColor: '#26a69a',
    wickDownColor: '#ef5350',
});

// –°–æ–∑–¥–∞—ë–º –º–µ–Ω–µ–¥–∂–µ—Ä
const tsManager = new ConsistentTimeScaleManager(chart, {
    expectedIntervalSeconds: 86400, // –î–Ω–µ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    excludeWeekends: true,
    holidays: ['2024-01-01', '2024-07-04', '2024-12-25'],
    targetVisibleBars: 80,
    minBarSpacing: 8,
});

// –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–±–µ–ª–∞–º–∏
const rawOHLCData = [
    { time: '2024-01-02', open: 100, high: 105, low: 98, close: 103 },
    { time: '2024-01-03', open: 103, high: 107, low: 102, close: 106 },
    // –ü—Ä–æ–±–µ–ª: 04-05 —è–Ω–≤–∞—Ä—è –ø—Ä–æ–ø—É—â–µ–Ω—ã
    { time: '2024-01-08', open: 106, high: 110, low: 104, close: 108 },
    { time: '2024-01-09', open: 108, high: 112, low: 107, close: 111 },
    // ... –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö
];

// –ü—Ä–∏–º–µ–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–æ–π
tsManager.applyToSeries(candleSeries, rawOHLCData);

// –û–±—Ä–∞–±–æ—Ç–∫–∞ resize
window.addEventListener('resize', () => {
    const newWidth = container.clientWidth;
    chart.resize(newWidth, 500);
    tsManager.configureTimeScale();
});
```

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ—à–µ–Ω–∏–π

| –†–µ—à–µ–Ω–∏–µ | –û—Ü–µ–Ω–∫–∞ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å | –ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å |
|---------|--------|-----------|---------------|--------------|
| **Whitespace Data** | ‚≠ê 9/10 | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∞—è | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è |
| –õ–æ–≥–∏—á–µ—Å–∫–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω | ‚≠ê 8/10 | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∞—è | –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å |
| –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ | ‚≠ê 8/10 | –í—ã—Å–æ–∫–∞—è | –í—ã—Å–æ–∫–∞—è | Multi-chart |
| –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ—Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π | ‚≠ê 8/10 | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω—è—è | –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ |
| –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ç–æ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö | ‚≠ê 7/10 | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω—è—è | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ |
| –ö–∞—Å—Ç–æ–º–Ω—ã–π tickFormatter | ‚≠ê 7/10 | –°—Ä–µ–¥–Ω—è—è | –ù–∏–∑–∫–∞—è | –ö–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∞—è |
| Padding —à–∏—Ä–∏–Ω—ã | ‚≠ê 6/10 | –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–∞—è | Edge cases |

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Issue #1809 –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ "Working as Intended"** ‚Äî —ç—Ç–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∞ –Ω–µ –±–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω.

2. **Lightweight Charts –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–≥–∏—á–µ—Å–∫—É—é –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é**, –∞ –Ω–µ —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

3. **–î–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç** (24/7 —Ç–æ—Ä–≥–∏) —Ä–µ—à–µ–Ω–∏–µ —Å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –≤—ã—Ö–æ–¥–Ω—ã—Ö –Ω–µ–ø—Ä–∏–º–µ–Ω–∏–º–æ.

4. **–ü—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤** —Å–ª–µ–¥—É–µ—Ç –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ü–∏–∫–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π.

---

## üîó –ò—Å—Ç–æ—á–Ω–∏–∫–∏

1. [GitHub Issue #1809 - Inconsistent TimeScale bar width and tick interval](https://github.com/tradingview/lightweight-charts/issues/1809)
2. [GitHub Issue #1426 - Irregular time scale when data has gaps](https://github.com/tradingview/lightweight-charts/issues/1426)
3. [Lightweight Charts - Time Scale API](https://tradingview.github.io/lightweight-charts/docs/api/interfaces/ITimeScaleApi)
4. [Lightweight Charts - Whitespace Data](https://tradingview.github.io/lightweight-charts/docs/series-types)
5. [GitHub - Time Scale Synchronization Examples](https://github.com/tradingview/lightweight-charts/issues?q=synchronize)

---

## üìÖ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –î–∞—Ç–∞ | –í–µ—Ä—Å–∏—è | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|--------|-----------|
| 2026-01-18 | 1.0 | –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ |

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ lightweight-charts error tracking*

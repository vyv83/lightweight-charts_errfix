# –ë–ê–ì #40: Whitespace –∏ –Ω–µ—Ä–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª—ã

> **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° –°–†–ï–î–ù–Ø–Ø  
> **Issues:** [#1426](https://github.com/tradingview/lightweight-charts/issues/1426), [#699](https://github.com/tradingview/lightweight-charts/issues/699), [#700](https://github.com/tradingview/lightweight-charts/issues/700)  
> **–í–µ—Ä—Å–∏–∏:** –í—Å–µ –≤–µ—Ä—Å–∏–∏  
> **–°—Ç–∞—Ç—É—Å:** üî¥ Open (—á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–µ–Ω–æ —á–µ—Ä–µ–∑ whitespace API)

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –°—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
Lightweight Charts **–Ω–µ —Å–æ–∑–¥–∞—ë—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–µ–ª—ã** (gaps) –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª–µ –¥–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤—Å–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –º–µ–∂–¥—É –Ω–∏–º–∏.

### –ü—Ä–æ—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã

1. **–°–∂–∞—Ç–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–µ–ª–æ–≤:**
   - –í—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ
   - –ë–æ–ª—å—à–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ –º–∞–ª–µ–Ω—å–∫–∏–µ
   - –õ–∏–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ —Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è "—á–µ—Ä–µ–∑ –Ω–æ—á—å" –±–µ–∑ –≤–∏–¥–∏–º–æ–≥–æ –ø—Ä–æ–±–µ–ª–∞

2. **–ù–µ—Ä–µ–≥—É–ª—è—Ä–Ω—ã–π –≤–∏–¥ —à–∫–∞–ª—ã –≤—Ä–µ–º–µ–Ω–∏:**
   - –ú–µ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ –ª–æ–≥–∏—á–µ—Å–∫–∏–º –∏–Ω–¥–µ–∫—Å–∞–º, –∞ –Ω–µ –ø–æ —Ä–µ–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏
   - –í–∏–∑—É–∞–ª—å–Ω–æ–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

3. **–ü—Ä–æ–±–ª–µ–º—ã —Å line series:**
   - Whitespace –¥–∞–Ω–Ω—ã–µ –Ω–µ –≤—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞—é—Ç –≤–∏–¥–∏–º—ã–µ —Ä–∞–∑—Ä—ã–≤—ã (Issue #700)
   - –õ–∏–Ω–∏—è –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Å–æ–µ–¥–∏–Ω—è—Ç—å—Å—è —á–µ—Ä–µ–∑ whitespace —Ç–æ—á–∫–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

```javascript
// –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ–±–µ–ª–æ–º (–≤—ã—Ö–æ–¥–Ω—ã–µ)
const data = [
    { time: '2024-01-05', value: 100 }, // –ü—è—Ç–Ω–∏—Ü–∞
    // –°—É–±–±–æ—Ç–∞ –∏ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –ø—Ä–æ–ø—É—â–µ–Ω—ã
    { time: '2024-01-08', value: 102 }, // –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
];

// –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ç–æ—á–∫–∏ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã —Ä—è–¥–æ–º –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º,
// –±–µ–∑ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è –Ω–∞ 3-–¥–Ω–µ–≤–Ω—ã–π –ø—Ä–æ–±–µ–ª
```

### –î–∏–∑–∞–π–Ω-—Ä–µ—à–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

Lightweight Charts –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–ª–æ–≥–∏—á–µ—Å–∫—É—é –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é** –≤–º–µ—Å—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–π:

```
–õ–æ–≥–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–µ–∫—Å: 0     1     2     3     4
                   ‚Üì     ‚Üì     ‚Üì     ‚Üì     ‚Üì
–î–∞–Ω–Ω—ã–µ:           Mon   Tue   Wed   Thu   Fri
                   
–ù–µ –±—É–¥–µ—Ç:         Mon   Tue   Wed   Thu   Fri   [gap]   [gap]   Mon
                   ‚Üì     ‚Üì     ‚Üì     ‚Üì     ‚Üì     ‚Üì       ‚Üì       ‚Üì
–õ–æ–≥–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–µ–∫—Å: 0     1     2     3     4     5       6       7
```

### –°–≤—è–∑—å –º–µ–∂–¥—É Issues

- **Issue #699** - "Ability to display gaps" (–æ—Å–Ω–æ–≤–Ω–æ–π feature request)
- **Issue #700** - "Whitespace on line series isn't showing the gaps" (–±–∞–≥)
- **Issue #1426** - "TimeScale is not regular when data has gaps" (–æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã)

---

## üîç –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: Whitespace Data Points (‚≠ê 9/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ whitespace –¥–∞–Ω–Ω—ã—Ö (—Ç–æ—á–∫–∏ —Ç–æ–ª—å–∫–æ —Å `time`, –±–µ–∑ `value`) –¥–ª—è —è–≤–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ–±–µ–ª–æ–≤.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
- ‚úÖ –°–æ–∑–¥–∞—ë—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã
- ‚úÖ –ì–∏–±–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª–æ–π

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –î–ª—è line series –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
/**
 * –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç whitespace –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–±–µ–ª–æ–≤
 */
function createWhitespaceForGaps(data, expectedIntervalMs) {
    if (data.length < 2) return data;

    const result = [];
    
    for (let i = 0; i < data.length; i++) {
        result.push(data[i]);
        
        if (i < data.length - 1) {
            const currentTime = getTimeInMs(data[i].time);
            const nextTime = getTimeInMs(data[i + 1].time);
            const gap = nextTime - currentTime;
            
            // –ï—Å–ª–∏ –ø—Ä–æ–±–µ–ª –±–æ–ª—å—à–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
            if (gap > expectedIntervalMs * 1.5) {
                // –ó–∞–ø–æ–ª–Ω—è–µ–º whitespace —Ç–æ—á–∫–∞–º–∏
                let fillTime = currentTime + expectedIntervalMs;
                
                while (fillTime < nextTime) {
                    result.push({ 
                        time: Math.floor(fillTime / 1000) // Unix timestamp –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
                    });
                    fillTime += expectedIntervalMs;
                }
            }
        }
    }
    
    return result;
}

function getTimeInMs(time) {
    if (typeof time === 'number') {
        return time * 1000; // Unix timestamp –≤ —Å–µ–∫—É–Ω–¥–∞—Ö ‚Üí ms
    }
    return new Date(time).getTime();
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const HOUR_MS = 60 * 60 * 1000;
const processedData = createWhitespaceForGaps(rawData, HOUR_MS);
series.setData(processedData);
```

---

### –†–µ—à–µ–Ω–∏–µ 2: –û—Ç–¥–µ–ª—å–Ω–∞—è Whitespace —Å–µ—Ä–∏—è (‚≠ê 8/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–π –Ω–µ–≤–∏–¥–∏–º–æ–π —Å–µ—Ä–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–ª–Ω—É—é –≤—Ä–µ–º–µ–Ω–Ω—É—é —à–∫–∞–ª—É, –≤–∫–ª—é—á–∞—è –≤—Å–µ –æ–∂–∏–¥–∞–µ–º—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ —à–∫–∞–ª—ã
- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- ‚úÖ –õ–µ–≥—á–µ —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–µ—Ä–∏—è
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
- ‚ùå –ú–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
import { createChart } from 'lightweight-charts';

/**
 * –ú–µ–Ω–µ–¥–∂–µ—Ä whitespace —Å–µ—Ä–∏–π
 */
class WhitespaceSeriesManager {
    constructor(chart) {
        this.chart = chart;
        this.whitespaceSeries = null;
    }

    /**
     * –°–æ–∑–¥–∞—ë—Ç whitespace —Å–µ—Ä–∏—é –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª—ã
     */
    createTimeScaleFrame(startTime, endTime, intervalSeconds) {
        // –°–æ–∑–¥–∞—ë–º –Ω–µ–≤–∏–¥–∏–º—É—é –ª–∏–Ω–µ–π–Ω—É—é —Å–µ—Ä–∏—é
        this.whitespaceSeries = this.chart.addLineSeries({
            visible: false, // –ù–µ–≤–∏–¥–∏–º–∞—è —Å–µ—Ä–∏—è
            priceScaleId: '', // –ë–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ price scale
        });

        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º whitespace –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
        const whitespaceData = this._generateTimeRange(
            startTime, 
            endTime, 
            intervalSeconds
        );
        
        this.whitespaceSeries.setData(whitespaceData);
        
        return whitespaceData;
    }

    _generateTimeRange(startTime, endTime, intervalSeconds) {
        const points = [];
        let currentTime = startTime;

        while (currentTime <= endTime) {
            points.push({ time: currentTime });
            currentTime += intervalSeconds;
        }

        return points;
    }

    /**
     * –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å whitespace —Ñ—Ä–µ–π–º–æ–º
     */
    mergeDataWithFrame(data, whitespaceTimes) {
        // –°–æ–∑–¥–∞—ë–º set –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
        const dataMap = new Map(data.map(d => [d.time, d]));
        
        // –ó–∞–º–µ–Ω—è–µ–º whitespace –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≥–¥–µ –æ–Ω–∏ –µ—Å—Ç—å
        return whitespaceTimes.map(ws => dataMap.get(ws.time) || ws);
    }
}

// ============ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ============

const chart = createChart(container, { width: 800, height: 400 });

const wsManager = new WhitespaceSeriesManager(chart);

// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ä–∞–º–∫—É (1 –Ω–µ–¥–µ–ª—è —Å —à–∞–≥–æ–º 1 —á–∞—Å)
const startTime = Math.floor(new Date('2024-01-01').getTime() / 1000);
const endTime = Math.floor(new Date('2024-01-07').getTime() / 1000);
const HOUR = 3600;

const timeFrame = wsManager.createTimeScaleFrame(startTime, endTime, HOUR);

// –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
const mainSeries = chart.addLineSeries({ color: '#2962FF' });
const mergedData = wsManager.mergeDataWithFrame(realData, timeFrame);
mainSeries.setData(mergedData);
```

---

### –†–µ—à–µ–Ω–∏–µ 3: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤—ã—Ö–æ–¥–Ω—ã—Ö —Å whitespace (‚≠ê 8/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–î–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–Ω–µ–π –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ whitespace –¥–ª—è –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤ –∏ –Ω–µ—Ä–∞–±–æ—á–∏—Ö –ø–µ—Ä–∏–æ–¥–æ–≤.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ß–∏—Å—Ç—ã–π –≥—Ä–∞—Ñ–∏–∫ –±–µ–∑ "–º—ë—Ä—Ç–≤—ã—Ö" –∑–æ–Ω
- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- ‚úÖ –£–º–µ–Ω—å—à–∞–µ—Ç –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ –¥–ª—è 24/7 —Ä—ã–Ω–∫–æ–≤
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –∑–Ω–∞–Ω–∏—è —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
/**
 * –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
 */
class FinancialDataProcessor {
    constructor(options = {}) {
        this.options = {
            excludeWeekends: options.excludeWeekends ?? true,
            tradingStartHour: options.tradingStartHour ?? 9,
            tradingEndHour: options.tradingEndHour ?? 17,
            holidays: new Set(options.holidays || []),
            timezone: options.timezone || 'UTC',
        };
    }

    /**
     * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –≤—Ä–µ–º—è —Ç–æ—Ä–≥–æ–≤—ã–º
     */
    isTradingTime(timestamp) {
        const date = new Date(timestamp * 1000);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã—Ö–æ–¥–Ω—ã–µ
        if (this.options.excludeWeekends) {
            const day = date.getUTCDay();
            if (day === 0 || day === 6) return false;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–∑–¥–Ω–∏–∫–∏
        const dateStr = date.toISOString().split('T')[0];
        if (this.options.holidays.has(dateStr)) return false;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ—Ä–≥–æ–≤—ã–µ —á–∞—Å—ã (–¥–ª—è intraday –¥–∞–Ω–Ω—ã—Ö)
        const hour = date.getUTCHours();
        if (hour < this.options.tradingStartHour || 
            hour >= this.options.tradingEndHour) {
            return false;
        }
        
        return true;
    }

    /**
     * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ, –¥–æ–±–∞–≤–ª—è—è whitespace –¥–ª—è –Ω–µ—Ä–∞–±–æ—á–∏—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
     */
    processData(data, intervalSeconds) {
        if (data.length === 0) return [];

        const result = [];
        
        for (let i = 0; i < data.length; i++) {
            const point = data[i];
            const time = typeof point.time === 'number' 
                ? point.time 
                : Math.floor(new Date(point.time).getTime() / 1000);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ—á–∫—É –¥–∞–Ω–Ω—ã—Ö
            result.push({ ...point, time });
            
            // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∞—è —Ç–æ—á–∫–∞, –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–±–µ–ª
            if (i < data.length - 1) {
                const nextTime = typeof data[i + 1].time === 'number'
                    ? data[i + 1].time
                    : Math.floor(new Date(data[i + 1].time).getTime() / 1000);
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–±–µ–ª—ã —Ç–æ–ª—å–∫–æ –≤ —Ç–æ—Ä–≥–æ–≤–æ–µ –≤—Ä–µ–º—è
                this._fillTradingGaps(result, time, nextTime, intervalSeconds);
            }
        }
        
        return result;
    }

    _fillTradingGaps(result, startTime, endTime, intervalSeconds) {
        let current = startTime + intervalSeconds;
        
        while (current < endTime) {
            if (this.isTradingTime(current)) {
                // –î–æ–±–∞–≤–ª—è–µ–º whitespace —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
                result.push({ time: current });
            }
            current += intervalSeconds;
        }
    }
}

// ============ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ============

const processor = new FinancialDataProcessor({
    excludeWeekends: true,
    tradingStartHour: 9,
    tradingEndHour: 17,
    holidays: ['2024-01-01', '2024-07-04', '2024-12-25'],
});

const MINUTE = 60;
const processedData = processor.processData(rawData, MINUTE);
series.setData(processedData);
```

---

### –†–µ—à–µ–Ω–∏–µ 4: TimeScale Options –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è whitespace (‚≠ê 7/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –æ–ø—Ü–∏–π `TimeScaleOptions` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –ø–æ–≤–µ–¥–µ–Ω–∏—è whitespace.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–∞—Ç–∏–≤–Ω—ã–π API
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –í–ª–∏—è–µ—Ç –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–µ—Ç–∫–∏ –∏ –∫—Ä–æ—Å—Å—Ö–µ–π—Ä–∞

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ù–µ —Å–æ–∑–¥–∞—ë—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚ùå –¢–æ–ª—å–∫–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –Ω–µ –Ω–∞ –¥–∞–Ω–Ω—ã–µ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
import { createChart } from 'lightweight-charts';

const chart = createChart(container, {
    width: 800,
    height: 400,
    timeScale: {
        /**
         * –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å whitespace –∏–Ω–¥–µ–∫—Å—ã –ø—Ä–∏:
         * - –†–∏—Å–æ–≤–∞–Ω–∏–∏ –ª–∏–Ω–∏–π —Å–µ—Ç–∫–∏
         * - –†–∏—Å–æ–≤–∞–Ω–∏–∏ —Ç–∏–∫–æ–≤
         * - –ü—Ä–∏–≤—è–∑–∫–µ –∫—Ä–æ—Å—Å—Ö–µ–π—Ä–∞
         */
        ignoreWhitespaceIndices: true,
        
        /**
         * –†–∞–∑—Ä–µ—à–∏—Ç—å —Å–¥–≤–∏–≥ –≤–∏–¥–∏–º–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –ø—Ä–∏ –∑–∞–º–µ–Ω–µ whitespace
         * –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–µ—Å–ª–∏ shiftVisibleRangeOnNewBar = true)
         */
        allowShiftVisibleRangeOnWhitespaceReplacement: true,
        
        /**
         * –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥ –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –±–∞—Ä–∞
         */
        shiftVisibleRangeOnNewBar: true,
        
        /**
         * –û—Ç—Å—Ç—É–ø —Å–ø—Ä–∞–≤–∞ –¥–ª—è whitespace
         */
        rightOffset: 10,
        
        /**
         * –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É –±–∞—Ä–∞–º–∏
         */
        minBarSpacing: 2,
    },
});
```

---

### –†–µ—à–µ–Ω–∏–µ 5: Real-time Whitespace Updates (‚≠ê 7/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–î–ª—è real-time –¥–∞–Ω–Ω—ã—Ö ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ whitespace –ø—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å live –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–µ–ª–æ–≤
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ—Å—É—Ä—Å–æ—ë–º–∫–∏–º
- ‚ùå –°–ª–æ–∂–Ω–µ–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
/**
 * –ú–µ–Ω–µ–¥–∂–µ—Ä real-time –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π whitespace
 */
class RealTimeWhitespaceManager {
    constructor(series, expectedIntervalSeconds) {
        this.series = series;
        this.expectedInterval = expectedIntervalSeconds;
        this.lastDataTime = null;
    }

    /**
     * –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–µ—Ä–∏—é —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º whitespace
     */
    update(newData) {
        const newTime = typeof newData.time === 'number'
            ? newData.time
            : Math.floor(new Date(newData.time).getTime() / 1000);

        // –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–∞—è —Ç–æ—á–∫–∞
        if (this.lastDataTime === null) {
            this.series.update(newData);
            this.lastDataTime = newTime;
            return;
        }

        // –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ–±–µ–ª
        const gap = newTime - this.lastDataTime;
        
        // –ï—Å–ª–∏ –ø—Ä–æ–±–µ–ª –±–æ–ª—å—à–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
        if (gap > this.expectedInterval * 1.5) {
            // –î–æ–±–∞–≤–ª—è–µ–º whitespace —Ç–æ—á–∫–∏
            let fillTime = this.lastDataTime + this.expectedInterval;
            
            while (fillTime < newTime) {
                this.series.update({ time: fillTime });
                fillTime += this.expectedInterval;
            }
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        this.series.update(newData);
        this.lastDataTime = newTime;
    }

    /**
     * –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–ª—è–µ—Ç whitespace –¥–æ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
     */
    fillToNow() {
        if (this.lastDataTime === null) return;
        
        const now = Math.floor(Date.now() / 1000);
        let fillTime = this.lastDataTime + this.expectedInterval;
        
        while (fillTime <= now) {
            this.series.update({ time: fillTime });
            fillTime += this.expectedInterval;
        }
    }
}

// ============ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å WebSocket ============

const chart = createChart(container, { width: 800, height: 400 });
const lineSeries = chart.addLineSeries({ color: '#2962FF' });

const MINUTE = 60;
const rtManager = new RealTimeWhitespaceManager(lineSeries, MINUTE);

// WebSocket connection
const ws = new WebSocket('wss://example.com/stream');

ws.onmessage = (event) => {
    const data = JSON.parse(event.data);
    rtManager.update({
        time: Math.floor(Date.now() / 1000),
        value: data.price,
    });
};

// –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–±–µ–ª—ã –µ—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
setInterval(() => {
    rtManager.fillToNow();
}, MINUTE * 1000);
```

---

### –†–µ—à–µ–Ω–∏–µ 6: Custom Series –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å gaps (‚≠ê 6/10)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–î–ª—è line series, –≥–¥–µ whitespace –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —Ä–∞–∑—Ä—ã–≤–æ–≤, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—Ö–æ–¥–Ω–æ–π –ø—É—Ç—å —Å area series –∏–ª–∏ custom rendering.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É Issue #700
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω—ã–µ —Ä–∞–∑—Ä—ã–≤—ã –≤ –ª–∏–Ω–∏–∏

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏
- ‚ùå –ú–æ–∂–µ—Ç –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
/**
 * –°–æ–∑–¥–∞—ë—Ç —Å–µ—Ä–∏—é —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —Ä–∞–∑—Ä—ã–≤–æ–≤
 */
function createGapSupportedSeries(chart, data, options = {}) {
    const {
        color = '#2962FF',
        lineWidth = 2,
        gapThreshold = 2, // –ú–Ω–æ–∂–∏—Ç–µ–ª—å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è gap
    } = options;

    // –†–∞–∑–±–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã –ø–æ gaps
    const segments = splitDataByGaps(data, gapThreshold);
    
    // –°–æ–∑–¥–∞—ë–º —Å–µ—Ä–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞
    const series = [];
    
    segments.forEach((segment, index) => {
        const s = chart.addLineSeries({
            color,
            lineWidth,
            // –ü–µ—Ä–≤—ã–π —Å–µ–≥–º–µ–Ω—Ç –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —à–∫–∞–ª–µ, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∫—Ä—ã–≤–∞—é—Ç –º–µ—Ç–∫—É
            lastValueVisible: index === segments.length - 1,
            priceLineVisible: index === segments.length - 1,
        });
        
        s.setData(segment);
        series.push(s);
    });
    
    return series;
}

function splitDataByGaps(data, gapMultiplier) {
    if (data.length < 2) return [data];
    
    // –í—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
    let totalInterval = 0;
    for (let i = 1; i < data.length; i++) {
        totalInterval += data[i].time - data[i - 1].time;
    }
    const avgInterval = totalInterval / (data.length - 1);
    const gapThreshold = avgInterval * gapMultiplier;
    
    const segments = [];
    let currentSegment = [data[0]];
    
    for (let i = 1; i < data.length; i++) {
        const gap = data[i].time - data[i - 1].time;
        
        if (gap > gapThreshold) {
            // –ù–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—ã–π —Å–µ–≥–º–µ–Ω—Ç
            segments.push(currentSegment);
            currentSegment = [data[i]];
        } else {
            currentSegment.push(data[i]);
        }
    }
    
    if (currentSegment.length > 0) {
        segments.push(currentSegment);
    }
    
    return segments;
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const allSeries = createGapSupportedSeries(chart, data, {
    color: '#2962FF',
    gapThreshold: 2,
});
```

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π Whitespace Manager

–û–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –ø–æ–¥—Ö–æ–¥—ã –≤ –µ–¥–∏–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ—Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:

```javascript
import { createChart } from 'lightweight-charts';

/**
 * –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä whitespace –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
 */
class WhitespaceManager {
    constructor(options = {}) {
        this.options = {
            expectedIntervalSeconds: options.expectedIntervalSeconds || 3600,
            gapMultiplier: options.gapMultiplier || 1.5,
            excludeWeekends: options.excludeWeekends ?? false,
            excludedHours: options.excludedHours || [], // [0-6] = –Ω–æ—á—å
            holidays: new Set(options.holidays || []),
            autoFillGaps: options.autoFillGaps ?? true,
        };
    }

    /**
     * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –¥–æ–ª–∂–Ω–æ –ª–∏ –≤—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è
     */
    shouldDisplayTime(timestamp) {
        const date = new Date(timestamp * 1000);
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö
        if (this.options.excludeWeekends) {
            const day = date.getUTCDay();
            if (day === 0 || day === 6) return false;
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤
        const dateStr = date.toISOString().split('T')[0];
        if (this.options.holidays.has(dateStr)) return false;
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∞—Å–æ–≤
        const hour = date.getUTCHours();
        if (this.options.excludedHours.includes(hour)) return false;
        
        return true;
    }

    /**
     * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å —É—á—ë—Ç–æ–º whitespace
     */
    processData(data) {
        if (!data || data.length === 0) return [];
        
        // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º timestamps
        const normalized = data.map(point => ({
            ...point,
            time: this._normalizeTime(point.time),
        }));

        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
        normalized.sort((a, b) => a.time - b.time);

        // –ó–∞–ø–æ–ª–Ω—è–µ–º gaps –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
        if (this.options.autoFillGaps) {
            return this._fillGaps(normalized);
        }

        return normalized;
    }

    _normalizeTime(time) {
        if (typeof time === 'number') return time;
        return Math.floor(new Date(time).getTime() / 1000);
    }

    _fillGaps(data) {
        const result = [];
        const interval = this.options.expectedIntervalSeconds;
        const threshold = interval * this.options.gapMultiplier;

        for (let i = 0; i < data.length; i++) {
            result.push(data[i]);

            if (i < data.length - 1) {
                const currentTime = data[i].time;
                const nextTime = data[i + 1].time;
                const gap = nextTime - currentTime;

                if (gap > threshold) {
                    let fillTime = currentTime + interval;
                    
                    while (fillTime < nextTime) {
                        if (this.shouldDisplayTime(fillTime)) {
                            result.push({ time: fillTime });
                        }
                        fillTime += interval;
                    }
                }
            }
        }

        return result;
    }

    /**
     * –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ñ—Ä–µ–π–º
     */
    generateTimeFrame(startTimestamp, endTimestamp) {
        const points = [];
        const interval = this.options.expectedIntervalSeconds;
        let current = startTimestamp;

        while (current <= endTimestamp) {
            if (this.shouldDisplayTime(current)) {
                points.push({ time: current });
            }
            current += interval;
        }

        return points;
    }

    /**
     * –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ñ—Ä–µ–π–º–æ–º
     */
    mergeWithTimeFrame(data, timeFrame) {
        const dataMap = new Map(
            data.map(d => [this._normalizeTime(d.time), d])
        );
        
        return timeFrame.map(tf => dataMap.get(tf.time) || tf);
    }

    /**
     * –°–æ–∑–¥–∞—ë—Ç real-time updater
     */
    createRealtimeUpdater(series) {
        return new RealtimeWhitespaceUpdater(series, this);
    }
}

/**
 * Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å whitespace
 */
class RealtimeWhitespaceUpdater {
    constructor(series, manager) {
        this.series = series;
        this.manager = manager;
        this.lastTime = null;
    }

    update(data) {
        const time = this.manager._normalizeTime(data.time);

        if (this.lastTime !== null) {
            const gap = time - this.lastTime;
            const threshold = this.manager.options.expectedIntervalSeconds * 
                              this.manager.options.gapMultiplier;

            if (gap > threshold) {
                let fillTime = this.lastTime + 
                               this.manager.options.expectedIntervalSeconds;
                
                while (fillTime < time) {
                    if (this.manager.shouldDisplayTime(fillTime)) {
                        this.series.update({ time: fillTime });
                    }
                    fillTime += this.manager.options.expectedIntervalSeconds;
                }
            }
        }

        this.series.update({ ...data, time });
        this.lastTime = time;
    }
}

// ============ –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ============

const container = document.getElementById('chart');

const chart = createChart(container, {
    width: 1000,
    height: 500,
    layout: {
        background: { type: 'solid', color: '#131722' },
        textColor: '#d1d4dc',
    },
    grid: {
        vertLines: { color: 'rgba(42, 46, 57, 0.6)' },
        horzLines: { color: 'rgba(42, 46, 57, 0.6)' },
    },
    timeScale: {
        timeVisible: true,
        secondsVisible: false,
        borderColor: '#485c7b',
        ignoreWhitespaceIndices: true,
    },
    rightPriceScale: {
        borderColor: '#485c7b',
    },
});

// –°–æ–∑–¥–∞—ë–º –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —á–∞—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –≤—ã—Ö–æ–¥–Ω—ã—Ö
const wsManager = new WhitespaceManager({
    expectedIntervalSeconds: 3600, // 1 —á–∞—Å
    excludeWeekends: true,
    holidays: ['2024-01-01', '2024-07-04', '2024-12-25'],
    autoFillGaps: true,
});

// –°–µ—Ä–∏—è —Å–≤–µ—á–µ–π
const candleSeries = chart.addCandlestickSeries({
    upColor: '#26a69a',
    downColor: '#ef5350',
    borderVisible: false,
    wickUpColor: '#26a69a',
    wickDownColor: '#ef5350',
});

// –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ–±–µ–ª–∞–º–∏
const rawData = [
    { time: '2024-01-02T10:00:00Z', open: 100, high: 102, low: 99, close: 101 },
    { time: '2024-01-02T11:00:00Z', open: 101, high: 103, low: 100, close: 102 },
    // –ü—Ä–æ–±–µ–ª: 12:00-14:00
    { time: '2024-01-02T15:00:00Z', open: 102, high: 104, low: 101, close: 103 },
    { time: '2024-01-02T16:00:00Z', open: 103, high: 105, low: 102, close: 104 },
];

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
const processedData = wsManager.processData(rawData);
candleSeries.setData(processedData);

// –î–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
const updater = wsManager.createRealtimeUpdater(candleSeries);

// –°–∏–º—É–ª—è—Ü–∏—è WebSocket
function simulateWebSocket() {
    const ws = new WebSocket('wss://example.com/stream');
    
    ws.onmessage = (event) => {
        const tick = JSON.parse(event.data);
        updater.update({
            time: tick.timestamp,
            open: tick.open,
            high: tick.high,
            low: tick.low,
            close: tick.close,
        });
    };
}

chart.timeScale().fitContent();
```

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ—à–µ–Ω–∏–π

| –†–µ—à–µ–Ω–∏–µ | –û—Ü–µ–Ω–∫–∞ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –í–∏–∑—É–∞–ª—å–Ω—ã–µ gaps | Real-time |
|---------|--------|-----------|-----------------|-----------|
| **Whitespace Data Points** | ‚≠ê 9/10 | –ù–∏–∑–∫–∞—è | ‚úÖ –î–∞ | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ |
| –û—Ç–¥–µ–ª—å–Ω–∞—è Whitespace —Å–µ—Ä–∏—è | ‚≠ê 8/10 | –°—Ä–µ–¥–Ω—è—è | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç |
| –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤—ã—Ö–æ–¥–Ω—ã—Ö | ‚≠ê 8/10 | –°—Ä–µ–¥–Ω—è—è | ‚úÖ –î–∞ | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ |
| TimeScale Options | ‚≠ê 7/10 | –ù–∏–∑–∫–∞—è | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |
| Real-time Whitespace | ‚≠ê 7/10 | –°—Ä–µ–¥–Ω—è—è | ‚úÖ –î–∞ | ‚úÖ –î–∞ |
| Custom Series segments | ‚≠ê 6/10 | –í—ã—Å–æ–∫–∞—è | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç |

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Issue #700 (Line series gaps)** ‚Äî whitespace –º–æ–∂–µ—Ç –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —Ä–∞–∑—Ä—ã–≤—ã –≤ line series. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ª–∏ area series –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É.

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚Äî –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ whitespace —Ç–æ—á–µ–∫ –º–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑—É–º–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã.

3. **Data Conflation (v5.1.0)** ‚Äî –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ gaps –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º zoom out.

4. **–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã** ‚Äî –¥–ª—è 24/7 —Ä—ã–Ω–∫–æ–≤ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω—ã—Ö.

---

## üîó –ò—Å—Ç–æ—á–Ω–∏–∫–∏

1. [GitHub Issue #1426 - TimeScale is not regular when data has gaps](https://github.com/tradingview/lightweight-charts/issues/1426)
2. [GitHub Issue #699 - Ability to display gaps](https://github.com/tradingview/lightweight-charts/issues/699)
3. [GitHub Issue #700 - Whitespace on line series isn't showing the gaps](https://github.com/tradingview/lightweight-charts/issues/700)
4. [Lightweight Charts - TimeScaleOptions](https://tradingview.github.io/lightweight-charts/docs/api/interfaces/TimeScaleOptions)
5. [Lightweight Charts - Series Types](https://tradingview.github.io/lightweight-charts/docs/series-types)
6. [Lightweight Charts - v5.1.0 Data Conflation](https://tradingview.github.io/lightweight-charts/)

---

## üìÖ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –î–∞—Ç–∞ | –í–µ—Ä—Å–∏—è | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|--------|-----------|
| 2026-01-18 | 1.0 | –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ |

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ lightweight-charts error tracking*
